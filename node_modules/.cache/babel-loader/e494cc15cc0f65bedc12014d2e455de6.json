{"ast":null,"code":"import _objectSpread from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";var _excluded=[\"disabled\",\"conversationId\",\"opponentId\",\"onSend\",\"messageMaxLen\"];import{v4 as uuidv4}from'uuid';import{Icon}from'@iconify/react';import{useRef,useState}from'react';import micFill from'@iconify/icons-eva/mic-fill';import roundSend from'@iconify/icons-ic/round-send';import attach2Fill from'@iconify/icons-eva/attach-2-fill';import roundAddPhotoAlternate from'@iconify/icons-ic/round-add-photo-alternate';// material\nimport{styled}from'@material-ui/core/styles';import{Input,Divider,IconButton,InputAdornment,Stack,Box}from'@material-ui/core';// redux\nimport{useDispatch,useSelector}from'../../../redux/store';import{addRecipients,onSendMessage,getConversation,getParticipants,markConversationAsRead,resetActiveConversation}from'../../../redux/slices/privatechat';import axios from'../../../utils/axios';// hooks\nimport useAuth from'../../../hooks/useAuth';//\nimport EmojiPicker from'../../EmojiPicker';// ----------------------------------------------------------------------\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RootStyle=styled('div')(function(_ref){var theme=_ref.theme;return{// minHeight: 56,\nheight:'auto',// display: 'flex',\nposition:'relative',alignItems:'center',paddingLeft:theme.spacing(2)};});var MessageImgStyle=styled('img')(function(_ref2){var theme=_ref2.theme;return{height:40,minWidth:40,width:'auto',cursor:'pointer',objectFit:'cover',borderRadius:theme.shape.borderRadius};});// ----------------------------------------------------------------------\nexport default function ChatMessageInput(_ref3){var disabled=_ref3.disabled,conversationId=_ref3.conversationId,opponentId=_ref3.opponentId,onSend=_ref3.onSend,messageMaxLen=_ref3.messageMaxLen,other=_objectWithoutProperties(_ref3,_excluded);var dispatch=useDispatch();var fileInputRef=useRef(null);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var _useAuth=useAuth(),user=_useAuth.user;var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),imageFiles=_useState4[0],setImageFiles=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),uploadImgs=_useState6[0],setUploadImgs=_useState6[1];var handleAttach=function handleAttach(){fileInputRef.current.click();};var handleImageUpload=function handleImageUpload(e){// console.log(e.target.files);\nvar fileObj=[];var fileArray=[];var formData=new FormData();fileObj.push(e.target.files);for(var i=0;i<fileObj[0].length;i+=1){var file=fileObj[0][i];formData.append(\"img[\".concat(i,\"]\"),file,file.name);fileArray.push({index:i,name:file.name,url:URL.createObjectURL(file)});}// console.log(fileArray);\nsetImageFiles(fileArray);setUploadImgs(formData);};var handleChangeMessage=function handleChangeMessage(event){setMessage(event.target.value);};var handleKeyUp=function handleKeyUp(event){if(event.key==='Enter'){handleSend();}};var handleSend=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var imgs,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!message&&imageFiles.length===0)){_context.next=2;break;}return _context.abrupt(\"return\",'');case 2:if(!onSend){_context.next=12;break;}// const accessToken = window.localStorage.getItem('accessToken');\n// const authHeader = {\n//   headers: {\n//     Authorization: `Bearer ${accessToken}`\n//   }\n// };\nimgs=[];if(!uploadImgs){_context.next=11;break;}_context.next=7;return axios.post('/message/upload_multi_imgs',uploadImgs);case 7:res=_context.sent;imgs=res.data.data;setImageFiles([]);setUploadImgs(null);case 11:onSend({conversationId:conversationId,messageId:uuidv4(),message:message,imgs:imgs,senderId:user._id,senderName:user.name,messageType:0,receiverId:opponentId});case 12:return _context.abrupt(\"return\",setMessage(''));case 13:case\"end\":return _context.stop();}}},_callee);}));return function handleSend(){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(RootStyle,_objectSpread(_objectSpread({},other),{},{children:[imageFiles.length>0&&/*#__PURE__*/_jsx(Stack,{direction:{xs:'column',sm:'row'},sx:{mt:1,mb:1},spacing:{xs:3,sm:2},children:imageFiles.map(function(img){return/*#__PURE__*/_jsx(MessageImgStyle,{alt:\"attachment\",src:\"\".concat(img.url)},\"\".concat(img.index));})}),/*#__PURE__*/_jsxs(Stack,{direction:{xs:'column',sm:'row'},sx:{mt:1,mb:1},children:[/*#__PURE__*/_jsx(Input,{disabled:disabled,fullWidth:true,value:message,disableUnderline:true,onKeyUp:handleKeyUp,onChange:handleChangeMessage,placeholder:\"Type a message\",inputProps:{maxLength:messageMaxLen||1000},startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(EmojiPicker,{disabled:disabled,value:message,setValue:setMessage})}),endAdornment:/*#__PURE__*/_jsx(Stack,{direction:\"row\",spacing:0.5,mr:1.5,children:/*#__PURE__*/_jsx(IconButton,{disabled:disabled,size:\"small\",onClick:handleAttach,children:/*#__PURE__*/_jsx(Icon,{icon:roundAddPhotoAlternate,width:24,height:24})})}),sx:{height:'100%'}}),/*#__PURE__*/_jsx(Divider,{orientation:\"vertical\",flexItem:true}),/*#__PURE__*/_jsx(IconButton,{color:\"primary\",disabled:!message&&imageFiles.length===0,onClick:handleSend,sx:{mx:1},children:/*#__PURE__*/_jsx(Icon,{icon:roundSend,width:24,height:24})})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",multiple:true,ref:fileInputRef,accept:\"image/*\",style:{display:'none'},onChange:handleImageUpload})]}));}","map":{"version":3,"sources":["E:/projects/localtalk.mobi/mobilechat-adminpanel/src/components/_dashboard/privatechat/ChatMessageInput.js"],"names":["v4","uuidv4","Icon","useRef","useState","micFill","roundSend","attach2Fill","roundAddPhotoAlternate","styled","Input","Divider","IconButton","InputAdornment","Stack","Box","useDispatch","useSelector","addRecipients","onSendMessage","getConversation","getParticipants","markConversationAsRead","resetActiveConversation","axios","useAuth","EmojiPicker","RootStyle","theme","height","position","alignItems","paddingLeft","spacing","MessageImgStyle","minWidth","width","cursor","objectFit","borderRadius","shape","ChatMessageInput","disabled","conversationId","opponentId","onSend","messageMaxLen","other","dispatch","fileInputRef","message","setMessage","user","imageFiles","setImageFiles","uploadImgs","setUploadImgs","handleAttach","current","click","handleImageUpload","e","fileObj","fileArray","formData","FormData","push","target","files","i","length","file","append","name","index","url","URL","createObjectURL","handleChangeMessage","event","value","handleKeyUp","key","handleSend","imgs","post","res","data","messageId","senderId","_id","senderName","messageType","receiverId","xs","sm","mt","mb","map","img","maxLength","mx","display"],"mappings":"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","sourcesContent":["import { v4 as uuidv4 } from 'uuid';\r\nimport PropTypes from 'prop-types';\r\nimport { Icon } from '@iconify/react';\r\nimport { useRef, useState } from 'react';\r\nimport micFill from '@iconify/icons-eva/mic-fill';\r\nimport roundSend from '@iconify/icons-ic/round-send';\r\nimport attach2Fill from '@iconify/icons-eva/attach-2-fill';\r\nimport roundAddPhotoAlternate from '@iconify/icons-ic/round-add-photo-alternate';\r\n// material\r\nimport { styled } from '@material-ui/core/styles';\r\nimport { Input, Divider, IconButton, InputAdornment, Stack, Box } from '@material-ui/core';\r\n// redux\r\nimport { useDispatch, useSelector } from '../../../redux/store';\r\nimport {\r\n  addRecipients,\r\n  onSendMessage,\r\n  getConversation,\r\n  getParticipants,\r\n  markConversationAsRead,\r\n  resetActiveConversation\r\n} from '../../../redux/slices/privatechat';\r\nimport axios from '../../../utils/axios';\r\n// hooks\r\nimport useAuth from '../../../hooks/useAuth';\r\n//\r\nimport EmojiPicker from '../../EmojiPicker';\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nconst RootStyle = styled('div')(({ theme }) => ({\r\n  // minHeight: 56,\r\n  height: 'auto',\r\n  // display: 'flex',\r\n  position: 'relative',\r\n  alignItems: 'center',\r\n  paddingLeft: theme.spacing(2)\r\n}));\r\n\r\nconst MessageImgStyle = styled('img')(({ theme }) => ({\r\n  height: 40,\r\n  minWidth: 40,\r\n  width: 'auto',\r\n  cursor: 'pointer',\r\n  objectFit: 'cover',\r\n  borderRadius: theme.shape.borderRadius\r\n}));\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nChatMessageInput.propTypes = {\r\n  disabled: PropTypes.bool,\r\n  conversationId: PropTypes.string,\r\n  opponentId: PropTypes.string,\r\n  onSend: PropTypes.func,\r\n  messageMaxLen: PropTypes.number\r\n};\r\n\r\nexport default function ChatMessageInput({ disabled, conversationId, opponentId, onSend, messageMaxLen, ...other }) {\r\n  const dispatch = useDispatch();\r\n  const fileInputRef = useRef(null);\r\n  const [message, setMessage] = useState('');\r\n  const { user } = useAuth();\r\n  const [imageFiles, setImageFiles] = useState([]);\r\n  const [uploadImgs, setUploadImgs] = useState(null);\r\n\r\n  const handleAttach = () => {\r\n    fileInputRef.current.click();\r\n  };\r\n\r\n  const handleImageUpload = (e) => {\r\n    // console.log(e.target.files);\r\n    const fileObj = [];\r\n    const fileArray = [];\r\n    const formData = new FormData();\r\n    fileObj.push(e.target.files);\r\n    for (let i = 0; i < fileObj[0].length; i += 1) {\r\n      const file = fileObj[0][i];\r\n      formData.append(`img[${i}]`, file, file.name);\r\n      fileArray.push({ index: i, name: file.name, url: URL.createObjectURL(file) });\r\n    }\r\n    // console.log(fileArray);\r\n    setImageFiles(fileArray);\r\n    setUploadImgs(formData);\r\n  };\r\n\r\n  const handleChangeMessage = (event) => {\r\n    setMessage(event.target.value);\r\n  };\r\n\r\n  const handleKeyUp = (event) => {\r\n    if (event.key === 'Enter') {\r\n      handleSend();\r\n    }\r\n  };\r\n\r\n  const handleSend = async () => {\r\n    if (!message && imageFiles.length === 0) {\r\n      return '';\r\n    }\r\n    if (onSend) {\r\n      // const accessToken = window.localStorage.getItem('accessToken');\r\n      // const authHeader = {\r\n      //   headers: {\r\n      //     Authorization: `Bearer ${accessToken}`\r\n      //   }\r\n      // };\r\n\r\n      let imgs = [];\r\n\r\n      if (uploadImgs) {\r\n        const res = await axios.post('/message/upload_multi_imgs', uploadImgs);\r\n        imgs = res.data.data;\r\n        setImageFiles([]);\r\n        setUploadImgs(null);\r\n      }\r\n\r\n      onSend({\r\n        conversationId,\r\n        messageId: uuidv4(),\r\n        message,\r\n        imgs,\r\n        senderId: user._id,\r\n        senderName: user.name,\r\n        messageType: 0,\r\n        receiverId: opponentId\r\n      });\r\n    }\r\n    return setMessage('');\r\n  };\r\n\r\n  return (\r\n    <RootStyle {...other}>\r\n      {imageFiles.length > 0 && (\r\n        <Stack direction={{ xs: 'column', sm: 'row' }} sx={{ mt: 1, mb: 1 }} spacing={{ xs: 3, sm: 2 }}>\r\n          {imageFiles.map((img) => (\r\n            <MessageImgStyle key={`${img.index}`} alt=\"attachment\" src={`${img.url}`} />\r\n          ))}\r\n        </Stack>\r\n      )}\r\n      <Stack direction={{ xs: 'column', sm: 'row' }} sx={{ mt: 1, mb: 1 }}>\r\n        <Input\r\n          disabled={disabled}\r\n          fullWidth\r\n          value={message}\r\n          disableUnderline\r\n          onKeyUp={handleKeyUp}\r\n          onChange={handleChangeMessage}\r\n          placeholder=\"Type a message\"\r\n          inputProps={{ maxLength: messageMaxLen || 1000 }}\r\n          startAdornment={\r\n            <InputAdornment position=\"start\">\r\n              <EmojiPicker disabled={disabled} value={message} setValue={setMessage} />\r\n            </InputAdornment>\r\n          }\r\n          endAdornment={\r\n            <Stack direction=\"row\" spacing={0.5} mr={1.5}>\r\n              <IconButton disabled={disabled} size=\"small\" onClick={handleAttach}>\r\n                <Icon icon={roundAddPhotoAlternate} width={24} height={24} />\r\n              </IconButton>\r\n              {/* <IconButton disabled={disabled} size=\"small\" onClick={handleAttach}>\r\n                <Icon icon={attach2Fill} width={24} height={24} />\r\n              </IconButton>\r\n              <IconButton disabled={disabled} size=\"small\">\r\n                <Icon icon={micFill} width={24} height={24} />\r\n              </IconButton> */}\r\n            </Stack>\r\n          }\r\n          sx={{ height: '100%' }}\r\n        />\r\n\r\n        <Divider orientation=\"vertical\" flexItem />\r\n\r\n        <IconButton color=\"primary\" disabled={!message && imageFiles.length === 0} onClick={handleSend} sx={{ mx: 1 }}>\r\n          <Icon icon={roundSend} width={24} height={24} />\r\n        </IconButton>\r\n      </Stack>\r\n\r\n      <input\r\n        type=\"file\"\r\n        multiple\r\n        ref={fileInputRef}\r\n        accept=\"image/*\"\r\n        style={{ display: 'none' }}\r\n        onChange={handleImageUpload}\r\n      />\r\n    </RootStyle>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}