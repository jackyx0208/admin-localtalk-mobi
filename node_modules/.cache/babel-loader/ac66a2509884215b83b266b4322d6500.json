{"ast":null,"code":"import _objectSpread from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";var _excluded=[\"message\",\"conversation\",\"onOpenLightbox\"];import{formatDistanceToNowStrict}from'date-fns';// material\nimport{styled}from'@material-ui/core/styles';import{Avatar,Box,Typography,Stack}from'@material-ui/core';import useAuth from'../../../hooks/useAuth';import{serverConfig}from'../../../config';// ----------------------------------------------------------------------\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RootStyle=styled('div')(function(_ref){var theme=_ref.theme;return{display:'flex',marginBottom:theme.spacing(3)};});var ContentStyle=styled('div')(function(_ref2){var theme=_ref2.theme;return{maxWidth:450,padding:theme.spacing(1.5),marginTop:theme.spacing(0.5),borderRadius:theme.shape.borderRadius,backgroundColor:theme.palette.background.neutral};});var InfoStyle=styled(Typography)(function(_ref3){var theme=_ref3.theme;return{display:'flex',marginBottom:theme.spacing(0.75),color:theme.palette.text.secondary};});var MessageImgStyle=styled('img')(function(_ref4){var theme=_ref4.theme;return{height:80,minWidth:100,width:'auto',cursor:'pointer',objectFit:'cover',borderRadius:theme.shape.borderRadius};});// ----------------------------------------------------------------------\nexport default function ChatMessageItem(_ref5){var message=_ref5.message,conversation=_ref5.conversation,onOpenLightbox=_ref5.onOpenLightbox,other=_objectWithoutProperties(_ref5,_excluded);var _useAuth=useAuth(),user=_useAuth.user;var sender=conversation.users.find(function(user){return user._id===message.sender_id;});var senderDetails=message.sender_id===user._id?{type:'me'}:{avatar:\"\".concat(serverConfig.baseUrl,\"/user/img-src/\").concat(sender.avatarUrl),name:sender.name};var isMe=senderDetails.type==='me';var firstName=senderDetails.name&&senderDetails.name.split(' ')[0];var replaceURLWithHTMLLinks=function replaceURLWithHTMLLinks(text){var exp=/(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gim;return text.replace(exp,function(url){return\"<a target=\\\"_blank\\\" href=\\\"\".concat(url,\"\\\">\").concat(url,\"</a>\");});};return/*#__PURE__*/_jsx(RootStyle,_objectSpread(_objectSpread({},other),{},{children:/*#__PURE__*/_jsxs(Box,{sx:_objectSpread({display:'flex'},isMe&&{ml:'auto'}),children:[senderDetails.type!=='me'&&/*#__PURE__*/_jsx(Avatar,{alt:senderDetails.name,src:senderDetails.avatar,sx:{width:32,height:32}}),/*#__PURE__*/_jsxs(Box,{sx:{ml:2},children:[/*#__PURE__*/_jsxs(InfoStyle,{noWrap:true,variant:\"caption\",sx:_objectSpread({},isMe&&{justifyContent:'flex-end'}),children:[!isMe&&\"\".concat(firstName,\",\"),\"\\xA0\",formatDistanceToNowStrict(new Date(message.createdAt),{addSuffix:true})]}),/*#__PURE__*/_jsxs(ContentStyle,{sx:_objectSpread({},isMe&&{color:'grey.800',bgcolor:'primary.lighter'}),children:[/*#__PURE__*/_jsx(Stack,{spacing:2,dangerouslySetInnerHTML:{__html:replaceURLWithHTMLLinks(message.message)}}),message.imgs.length>0&&/*#__PURE__*/_jsx(Stack,{direction:{xs:'column',sm:'row'},spacing:{xs:3,sm:2},children:message.imgs.map(function(img){return/*#__PURE__*/_jsx(MessageImgStyle,{alt:\"attachment\",src:\"\".concat(serverConfig.baseUrl,\"/message/img-src/\").concat(img),onClick:function onClick(){return onOpenLightbox(\"\".concat(serverConfig.baseUrl,\"/message/img-src/\").concat(img));}},\"\".concat(img));})})]})]})]})}));}","map":{"version":3,"sources":["E:/projects/localtalk.mobi/mobilechat-adminpanel/src/components/_dashboard/privatechat/ChatMessageItem.js"],"names":["formatDistanceToNowStrict","styled","Avatar","Box","Typography","Stack","useAuth","serverConfig","RootStyle","theme","display","marginBottom","spacing","ContentStyle","maxWidth","padding","marginTop","borderRadius","shape","backgroundColor","palette","background","neutral","InfoStyle","color","text","secondary","MessageImgStyle","height","minWidth","width","cursor","objectFit","ChatMessageItem","message","conversation","onOpenLightbox","other","user","sender","users","find","_id","sender_id","senderDetails","type","avatar","baseUrl","avatarUrl","name","isMe","firstName","split","replaceURLWithHTMLLinks","exp","replace","url","ml","justifyContent","Date","createdAt","addSuffix","bgcolor","__html","imgs","length","xs","sm","map","img"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types';\r\nimport { formatDistanceToNowStrict } from 'date-fns';\r\n// material\r\nimport { styled } from '@material-ui/core/styles';\r\nimport { Avatar, Box, Typography, Stack } from '@material-ui/core';\r\n\r\nimport useAuth from '../../../hooks/useAuth';\r\n\r\nimport { serverConfig } from '../../../config';\r\n// ----------------------------------------------------------------------\r\n\r\nconst RootStyle = styled('div')(({ theme }) => ({\r\n  display: 'flex',\r\n  marginBottom: theme.spacing(3)\r\n}));\r\n\r\nconst ContentStyle = styled('div')(({ theme }) => ({\r\n  maxWidth: 450,\r\n  padding: theme.spacing(1.5),\r\n  marginTop: theme.spacing(0.5),\r\n  borderRadius: theme.shape.borderRadius,\r\n  backgroundColor: theme.palette.background.neutral\r\n}));\r\n\r\nconst InfoStyle = styled(Typography)(({ theme }) => ({\r\n  display: 'flex',\r\n  marginBottom: theme.spacing(0.75),\r\n  color: theme.palette.text.secondary\r\n}));\r\n\r\nconst MessageImgStyle = styled('img')(({ theme }) => ({\r\n  height: 80,\r\n  minWidth: 100,\r\n  width: 'auto',\r\n  cursor: 'pointer',\r\n  objectFit: 'cover',\r\n  borderRadius: theme.shape.borderRadius\r\n}));\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nChatMessageItem.propTypes = {\r\n  message: PropTypes.object.isRequired,\r\n  conversation: PropTypes.object.isRequired,\r\n  onOpenLightbox: PropTypes.func\r\n};\r\n\r\nexport default function ChatMessageItem({ message, conversation, onOpenLightbox, ...other }) {\r\n  const { user } = useAuth();\r\n  const sender = conversation.users.find((user) => user._id === message.sender_id);\r\n  const senderDetails =\r\n    message.sender_id === user._id\r\n      ? { type: 'me' }\r\n      : { avatar: `${serverConfig.baseUrl}/user/img-src/${sender.avatarUrl}`, name: sender.name };\r\n\r\n  const isMe = senderDetails.type === 'me';\r\n  const firstName = senderDetails.name && senderDetails.name.split(' ')[0];\r\n\r\n  const replaceURLWithHTMLLinks = (text) => {\r\n    const exp = /(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gim;\r\n    return text.replace(exp, (url) => `<a target=\"_blank\" href=\"${url}\">${url}</a>`);\r\n  };\r\n\r\n  return (\r\n    <RootStyle {...other}>\r\n      <Box\r\n        sx={{\r\n          display: 'flex',\r\n          ...(isMe && {\r\n            ml: 'auto'\r\n          })\r\n        }}\r\n      >\r\n        {senderDetails.type !== 'me' && (\r\n          <Avatar alt={senderDetails.name} src={senderDetails.avatar} sx={{ width: 32, height: 32 }} />\r\n        )}\r\n\r\n        <Box sx={{ ml: 2 }}>\r\n          <InfoStyle noWrap variant=\"caption\" sx={{ ...(isMe && { justifyContent: 'flex-end' }) }}>\r\n            {!isMe && `${firstName},`}&nbsp;\r\n            {formatDistanceToNowStrict(new Date(message.createdAt), {\r\n              addSuffix: true\r\n            })}\r\n          </InfoStyle>\r\n\r\n          <ContentStyle\r\n            sx={{\r\n              ...(isMe && {\r\n                color: 'grey.800',\r\n                bgcolor: 'primary.lighter'\r\n              })\r\n            }}\r\n          >\r\n            <Stack spacing={2} dangerouslySetInnerHTML={{ __html: replaceURLWithHTMLLinks(message.message) }} />\r\n            {message.imgs.length > 0 && (\r\n              <Stack direction={{ xs: 'column', sm: 'row' }} spacing={{ xs: 3, sm: 2 }}>\r\n                {message.imgs.map((img) => (\r\n                  <MessageImgStyle\r\n                    key={`${img}`}\r\n                    alt=\"attachment\"\r\n                    src={`${serverConfig.baseUrl}/message/img-src/${img}`}\r\n                    onClick={() => onOpenLightbox(`${serverConfig.baseUrl}/message/img-src/${img}`)}\r\n                  />\r\n                ))}\r\n              </Stack>\r\n            )}\r\n          </ContentStyle>\r\n        </Box>\r\n      </Box>\r\n    </RootStyle>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}