{"ast":null,"code":"import _objectSpread from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Icon}from'@iconify/react';import{useState,useEffect}from'react';import editFill from'@iconify/icons-eva/edit-fill';import{useNavigate,Link as RouterLink}from'react-router-dom';import arrowIosBackFill from'@iconify/icons-eva/arrow-ios-back-fill';import arrowIosForwardFill from'@iconify/icons-eva/arrow-ios-forward-fill';// material\nimport{useTheme,styled}from'@material-ui/core/styles';import{Box,useMediaQuery}from'@material-ui/core';// redux\nimport{useSelector}from'../../../redux/store';// utils\nimport axios from'../../../utils/axios';// routes\nimport{PATH_DASHBOARD}from'../../../routes/paths';//\nimport{MIconButton}from'../../@material-extend';import Scrollbar from'../../Scrollbar';import ChatAccount from'./ChatAccount';import ChatSearchResults from'./ChatSearchResults';import ChatContactSearch from'./ChatContactSearch';import ChatConversationList from'./ChatConversationList';// ----------------------------------------------------------------------\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RootStyle=styled('div')(function(_ref){var theme=_ref.theme;return{width:320,flexShrink:0,display:'flex',flexDirection:'column',transition:theme.transitions.create('width'),borderRight:\"1px solid \".concat(theme.palette.divider)};});// ----------------------------------------------------------------------\nexport default function ChatSidebar(){var theme=useTheme();var navigate=useNavigate();var isMobile=useMediaQuery(theme.breakpoints.down('md'));var _useState=useState(true),_useState2=_slicedToArray(_useState,2),openSidebar=_useState2[0],setOpenSidebar=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),searchQuery=_useState4[0],setSearchQuery=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),searchResults=_useState6[0],setSearchResults=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isSearchFocused=_useState8[0],setSearchFocused=_useState8[1];var displayResults=searchQuery&&isSearchFocused;var _useSelector=useSelector(function(state){return state.chat;}),conversations=_useSelector.conversations,activeConversationId=_useSelector.activeConversationId;console.log(activeConversationId);useEffect(function(){if(isMobile){return setOpenSidebar(false);}return setOpenSidebar(true);},[isMobile]);// eslint-disable-next-line consistent-return\nuseEffect(function(){if(!openSidebar){return setSearchFocused(false);}},[openSidebar]);var handleClickAwaySearch=function handleClickAwaySearch(){setSearchFocused(false);setSearchQuery('');};var handleChangeSearch=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var value,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;value=event.target.value;setSearchQuery(value);if(!value){_context.next=10;break;}_context.next=6;return axios.get('/chat/search',{params:{query:value}});case 6:response=_context.sent;setSearchResults(response.data.results);_context.next=11;break;case 10:setSearchResults([]);case 11:_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function handleChangeSearch(_x){return _ref2.apply(this,arguments);};}();var handleSearchFocus=function handleSearchFocus(){setSearchFocused(true);};var handleSearchSelect=function handleSearchSelect(username){setSearchFocused(false);setSearchQuery('');navigate(\"\".concat(PATH_DASHBOARD.chat.root,\"/\").concat(username));};var handleSelectContact=function handleSelectContact(result){if(handleSearchSelect){handleSearchSelect(result.username);}};return/*#__PURE__*/_jsxs(RootStyle,{sx:_objectSpread({},!openSidebar&&{width:96}),children:[/*#__PURE__*/_jsxs(Box,{sx:{py:2,px:3},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[openSidebar&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Box,{sx:{flexGrow:1}})}),/*#__PURE__*/_jsx(MIconButton,{onClick:function onClick(){return setOpenSidebar(!openSidebar);},children:/*#__PURE__*/_jsx(Icon,{width:20,height:20,icon:openSidebar?arrowIosBackFill:arrowIosForwardFill})})]}),openSidebar&&/*#__PURE__*/_jsx(ChatContactSearch,{query:searchQuery,onFocus:handleSearchFocus,onChange:handleChangeSearch,onClickAway:handleClickAwaySearch})]}),/*#__PURE__*/_jsx(Scrollbar,{children:!displayResults?/*#__PURE__*/_jsx(ChatConversationList,{conversations:conversations,isOpenSidebar:openSidebar,activeConversationId:activeConversationId,sx:_objectSpread({},isSearchFocused&&{display:'none'})}):/*#__PURE__*/_jsx(ChatSearchResults,{query:searchQuery,results:searchResults,onSelectContact:handleSelectContact})})]});}","map":{"version":3,"sources":["E:/projects/localtalk.mobi/mobilechat-adminpanel/src/components/_dashboard/chat/ChatSidebar.js"],"names":["Icon","useState","useEffect","editFill","useNavigate","Link","RouterLink","arrowIosBackFill","arrowIosForwardFill","useTheme","styled","Box","useMediaQuery","useSelector","axios","PATH_DASHBOARD","MIconButton","Scrollbar","ChatAccount","ChatSearchResults","ChatContactSearch","ChatConversationList","RootStyle","theme","width","flexShrink","display","flexDirection","transition","transitions","create","borderRight","palette","divider","ChatSidebar","navigate","isMobile","breakpoints","down","openSidebar","setOpenSidebar","searchQuery","setSearchQuery","searchResults","setSearchResults","isSearchFocused","setSearchFocused","displayResults","state","chat","conversations","activeConversationId","console","log","handleClickAwaySearch","handleChangeSearch","event","value","target","get","params","query","response","data","results","error","handleSearchFocus","handleSearchSelect","username","root","handleSelectContact","result","py","px","alignItems","flexGrow"],"mappings":"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","sourcesContent":["import { Icon } from '@iconify/react';\r\nimport { useState, useEffect } from 'react';\r\nimport editFill from '@iconify/icons-eva/edit-fill';\r\n\r\nimport { useNavigate, Link as RouterLink } from 'react-router-dom';\r\nimport arrowIosBackFill from '@iconify/icons-eva/arrow-ios-back-fill';\r\nimport arrowIosForwardFill from '@iconify/icons-eva/arrow-ios-forward-fill';\r\n// material\r\nimport { useTheme, styled } from '@material-ui/core/styles';\r\nimport { Box, useMediaQuery } from '@material-ui/core';\r\n// redux\r\nimport { useSelector } from '../../../redux/store';\r\n// utils\r\nimport axios from '../../../utils/axios';\r\n// routes\r\nimport { PATH_DASHBOARD } from '../../../routes/paths';\r\n//\r\nimport { MIconButton } from '../../@material-extend';\r\nimport Scrollbar from '../../Scrollbar';\r\nimport ChatAccount from './ChatAccount';\r\nimport ChatSearchResults from './ChatSearchResults';\r\nimport ChatContactSearch from './ChatContactSearch';\r\nimport ChatConversationList from './ChatConversationList';\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nconst RootStyle = styled('div')(({ theme }) => ({\r\n  width: 320,\r\n  flexShrink: 0,\r\n  display: 'flex',\r\n  flexDirection: 'column',\r\n  transition: theme.transitions.create('width'),\r\n  borderRight: `1px solid ${theme.palette.divider}`\r\n}));\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nexport default function ChatSidebar() {\r\n  const theme = useTheme();\r\n  const navigate = useNavigate();\r\n  const isMobile = useMediaQuery(theme.breakpoints.down('md'));\r\n  const [openSidebar, setOpenSidebar] = useState(true);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [isSearchFocused, setSearchFocused] = useState(false);\r\n  const displayResults = searchQuery && isSearchFocused;\r\n  const { conversations, activeConversationId } = useSelector((state) => state.chat);\r\n  console.log(activeConversationId);\r\n\r\n  useEffect(() => {\r\n    if (isMobile) {\r\n      return setOpenSidebar(false);\r\n    }\r\n    return setOpenSidebar(true);\r\n  }, [isMobile]);\r\n\r\n  // eslint-disable-next-line consistent-return\r\n  useEffect(() => {\r\n    if (!openSidebar) {\r\n      return setSearchFocused(false);\r\n    }\r\n  }, [openSidebar]);\r\n\r\n  const handleClickAwaySearch = () => {\r\n    setSearchFocused(false);\r\n    setSearchQuery('');\r\n  };\r\n\r\n  const handleChangeSearch = async (event) => {\r\n    try {\r\n      const { value } = event.target;\r\n      setSearchQuery(value);\r\n      if (value) {\r\n        const response = await axios.get('/chat/search', {\r\n          params: { query: value }\r\n        });\r\n        setSearchResults(response.data.results);\r\n      } else {\r\n        setSearchResults([]);\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const handleSearchFocus = () => {\r\n    setSearchFocused(true);\r\n  };\r\n\r\n  const handleSearchSelect = (username) => {\r\n    setSearchFocused(false);\r\n    setSearchQuery('');\r\n    navigate(`${PATH_DASHBOARD.chat.root}/${username}`);\r\n  };\r\n\r\n  const handleSelectContact = (result) => {\r\n    if (handleSearchSelect) {\r\n      handleSearchSelect(result.username);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <RootStyle sx={{ ...(!openSidebar && { width: 96 }) }}>\r\n      <Box sx={{ py: 2, px: 3 }}>\r\n        <Box sx={{ display: 'flex', alignItems: 'center' }}>\r\n          {openSidebar && (\r\n            <>\r\n              <Box sx={{ flexGrow: 1 }} />\r\n            </>\r\n          )}\r\n\r\n          <MIconButton onClick={() => setOpenSidebar(!openSidebar)}>\r\n            <Icon width={20} height={20} icon={openSidebar ? arrowIosBackFill : arrowIosForwardFill} />\r\n          </MIconButton>\r\n        </Box>\r\n\r\n        {openSidebar && (\r\n          <ChatContactSearch\r\n            query={searchQuery}\r\n            onFocus={handleSearchFocus}\r\n            onChange={handleChangeSearch}\r\n            onClickAway={handleClickAwaySearch}\r\n          />\r\n        )}\r\n      </Box>\r\n\r\n      <Scrollbar>\r\n        {!displayResults ? (\r\n          <ChatConversationList\r\n            conversations={conversations}\r\n            isOpenSidebar={openSidebar}\r\n            activeConversationId={activeConversationId}\r\n            sx={{ ...(isSearchFocused && { display: 'none' }) }}\r\n          />\r\n        ) : (\r\n          <ChatSearchResults query={searchQuery} results={searchResults} onSelectContact={handleSelectContact} />\r\n        )}\r\n      </Scrollbar>\r\n    </RootStyle>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}