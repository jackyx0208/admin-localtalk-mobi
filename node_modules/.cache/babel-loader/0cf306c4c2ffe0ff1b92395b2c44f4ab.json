{"ast":null,"code":"import _objectSpread from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Icon}from'@iconify/react';import{useState,useEffect}from'react';import editFill from'@iconify/icons-eva/edit-fill';import{useNavigate,Link as RouterLink}from'react-router-dom';import arrowIosBackFill from'@iconify/icons-eva/arrow-ios-back-fill';import arrowIosForwardFill from'@iconify/icons-eva/arrow-ios-forward-fill';// material\nimport{useTheme,styled}from'@material-ui/core/styles';import{Box,useMediaQuery,Checkbox,FormControlLabel}from'@material-ui/core';// redux\nimport{useSelector}from'../../../redux/store';// utils\nimport axios from'../../../utils/axios';// routes\nimport{PATH_DASHBOARD}from'../../../routes/paths';import{MIconButton}from'../../@material-extend';import Scrollbar from'../../Scrollbar';import ChatAccount from'./ChatAccount';import ChatSearchResults from'./ChatSearchResults';import ChatContactSearch from'./ChatContactSearch';import ChatConversationList from'./ChatConversationList';// ----------------------------------------------------------------------\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RootStyle=styled('div')(function(_ref){var theme=_ref.theme;return{width:320,flexShrink:0,display:'flex',flexDirection:'column',transition:theme.transitions.create('width'),borderRight:\"1px solid \".concat(theme.palette.divider)};});// ----------------------------------------------------------------------\nexport default function ChatSidebar(){var theme=useTheme();var navigate=useNavigate();var isMobile=useMediaQuery(theme.breakpoints.down('md'));var _useState=useState(true),_useState2=_slicedToArray(_useState,2),openSidebar=_useState2[0],setOpenSidebar=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),searchQuery=_useState4[0],setSearchQuery=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),searchResults=_useState6[0],setSearchResults=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isSearchFocused=_useState8[0],setSearchFocused=_useState8[1];var displayResults=searchQuery&&isSearchFocused;var _useSelector=useSelector(function(state){return state.privatechat;}),conversations=_useSelector.conversations,activeConversationId=_useSelector.activeConversationId;var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),onlyUnreadShow=_useState10[0],setOnlyUnreadShow=_useState10[1];useEffect(function(){if(isMobile){return setOpenSidebar(false);}return setOpenSidebar(true);},[isMobile]);// eslint-disable-next-line consistent-return\nuseEffect(function(){if(!openSidebar){return setSearchFocused(false);}},[openSidebar]);var handleClickAwaySearch=function handleClickAwaySearch(){setSearchFocused(false);setSearchQuery('');};var handleChangeSearch=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var value,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;value=event.target.value;setSearchQuery(value);if(!value){_context.next=10;break;}_context.next=6;return axios.get('/chat/search',{params:{query:value}});case 6:response=_context.sent;setSearchResults(response.data.results);_context.next=11;break;case 10:setSearchResults([]);case 11:_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function handleChangeSearch(_x){return _ref2.apply(this,arguments);};}();var handleSearchFocus=function handleSearchFocus(){setSearchFocused(true);};var handleSearchSelect=function handleSearchSelect(username){setSearchFocused(false);setSearchQuery('');navigate(\"\".concat(PATH_DASHBOARD.chat.root,\"/\").concat(username));};var handleSelectContact=function handleSelectContact(result){if(handleSearchSelect){handleSearchSelect(result.username);}};var handleUnreadShowChange=function handleUnreadShowChange(e){setOnlyUnreadShow(e.target.checked);};return/*#__PURE__*/_jsxs(RootStyle,{sx:_objectSpread({},!openSidebar&&{width:96}),children:[/*#__PURE__*/_jsxs(Box,{sx:{py:2,px:3},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[openSidebar&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Box,{sx:{flexGrow:1}})}),/*#__PURE__*/_jsx(MIconButton,{onClick:function onClick(){return setOpenSidebar(!openSidebar);},children:/*#__PURE__*/_jsx(Icon,{width:20,height:20,icon:openSidebar?arrowIosBackFill:arrowIosForwardFill})})]}),openSidebar&&/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(ChatContactSearch,{query:searchQuery,onFocus:handleSearchFocus,onChange:handleChangeSearch,onClickAway:handleClickAwaySearch}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{checked:onlyUnreadShow,onChange:handleUnreadShowChange}),label:\"display unread chat partner only\"})]})]}),/*#__PURE__*/_jsx(Scrollbar,{children:/*#__PURE__*/_jsx(ChatConversationList,{conversations:conversations,isOpenSidebar:openSidebar,activeConversationId:activeConversationId// sx={{ ...(isSearchFocused && { display: 'none' }) }}\n,query:searchQuery,onlyUnreadShow:onlyUnreadShow})})]});}","map":{"version":3,"sources":["E:/projects/localtalk.mobi/mobilechat-adminpanel/src/components/_dashboard/privatechat/ChatSidebar.js"],"names":["Icon","useState","useEffect","editFill","useNavigate","Link","RouterLink","arrowIosBackFill","arrowIosForwardFill","useTheme","styled","Box","useMediaQuery","Checkbox","FormControlLabel","useSelector","axios","PATH_DASHBOARD","MIconButton","Scrollbar","ChatAccount","ChatSearchResults","ChatContactSearch","ChatConversationList","RootStyle","theme","width","flexShrink","display","flexDirection","transition","transitions","create","borderRight","palette","divider","ChatSidebar","navigate","isMobile","breakpoints","down","openSidebar","setOpenSidebar","searchQuery","setSearchQuery","searchResults","setSearchResults","isSearchFocused","setSearchFocused","displayResults","state","privatechat","conversations","activeConversationId","onlyUnreadShow","setOnlyUnreadShow","handleClickAwaySearch","handleChangeSearch","event","value","target","get","params","query","response","data","results","console","error","handleSearchFocus","handleSearchSelect","username","chat","root","handleSelectContact","result","handleUnreadShowChange","e","checked","py","px","alignItems","flexGrow"],"mappings":"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","sourcesContent":["import { Icon } from '@iconify/react';\r\nimport { useState, useEffect } from 'react';\r\nimport editFill from '@iconify/icons-eva/edit-fill';\r\n\r\nimport { useNavigate, Link as RouterLink } from 'react-router-dom';\r\nimport arrowIosBackFill from '@iconify/icons-eva/arrow-ios-back-fill';\r\nimport arrowIosForwardFill from '@iconify/icons-eva/arrow-ios-forward-fill';\r\n// material\r\nimport { useTheme, styled } from '@material-ui/core/styles';\r\nimport { Box, useMediaQuery, Checkbox, FormControlLabel } from '@material-ui/core';\r\n// redux\r\nimport { useSelector } from '../../../redux/store';\r\n// utils\r\nimport axios from '../../../utils/axios';\r\n// routes\r\nimport { PATH_DASHBOARD } from '../../../routes/paths';\r\n\r\nimport { MIconButton } from '../../@material-extend';\r\nimport Scrollbar from '../../Scrollbar';\r\nimport ChatAccount from './ChatAccount';\r\nimport ChatSearchResults from './ChatSearchResults';\r\nimport ChatContactSearch from './ChatContactSearch';\r\nimport ChatConversationList from './ChatConversationList';\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nconst RootStyle = styled('div')(({ theme }) => ({\r\n  width: 320,\r\n  flexShrink: 0,\r\n  display: 'flex',\r\n  flexDirection: 'column',\r\n  transition: theme.transitions.create('width'),\r\n  borderRight: `1px solid ${theme.palette.divider}`\r\n}));\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nexport default function ChatSidebar() {\r\n  const theme = useTheme();\r\n  const navigate = useNavigate();\r\n  const isMobile = useMediaQuery(theme.breakpoints.down('md'));\r\n  const [openSidebar, setOpenSidebar] = useState(true);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [isSearchFocused, setSearchFocused] = useState(false);\r\n  const displayResults = searchQuery && isSearchFocused;\r\n  const { conversations, activeConversationId } = useSelector((state) => state.privatechat);\r\n  const [onlyUnreadShow, setOnlyUnreadShow] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isMobile) {\r\n      return setOpenSidebar(false);\r\n    }\r\n    return setOpenSidebar(true);\r\n  }, [isMobile]);\r\n\r\n  // eslint-disable-next-line consistent-return\r\n  useEffect(() => {\r\n    if (!openSidebar) {\r\n      return setSearchFocused(false);\r\n    }\r\n  }, [openSidebar]);\r\n\r\n  const handleClickAwaySearch = () => {\r\n    setSearchFocused(false);\r\n    setSearchQuery('');\r\n  };\r\n\r\n  const handleChangeSearch = async (event) => {\r\n    try {\r\n      const { value } = event.target;\r\n      setSearchQuery(value);\r\n      if (value) {\r\n        const response = await axios.get('/chat/search', {\r\n          params: { query: value }\r\n        });\r\n        setSearchResults(response.data.results);\r\n      } else {\r\n        setSearchResults([]);\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const handleSearchFocus = () => {\r\n    setSearchFocused(true);\r\n  };\r\n\r\n  const handleSearchSelect = (username) => {\r\n    setSearchFocused(false);\r\n    setSearchQuery('');\r\n    navigate(`${PATH_DASHBOARD.chat.root}/${username}`);\r\n  };\r\n\r\n  const handleSelectContact = (result) => {\r\n    if (handleSearchSelect) {\r\n      handleSearchSelect(result.username);\r\n    }\r\n  };\r\n\r\n  const handleUnreadShowChange = (e) => {\r\n    setOnlyUnreadShow(e.target.checked);\r\n  };\r\n\r\n  return (\r\n    <RootStyle sx={{ ...(!openSidebar && { width: 96 }) }}>\r\n      <Box sx={{ py: 2, px: 3 }}>\r\n        <Box sx={{ display: 'flex', alignItems: 'center' }}>\r\n          {openSidebar && (\r\n            <>\r\n              <Box sx={{ flexGrow: 1 }} />\r\n            </>\r\n          )}\r\n\r\n          <MIconButton onClick={() => setOpenSidebar(!openSidebar)}>\r\n            <Icon width={20} height={20} icon={openSidebar ? arrowIosBackFill : arrowIosForwardFill} />\r\n          </MIconButton>\r\n        </Box>\r\n\r\n        {openSidebar && (\r\n          <Box>\r\n            <ChatContactSearch\r\n              query={searchQuery}\r\n              onFocus={handleSearchFocus}\r\n              onChange={handleChangeSearch}\r\n              onClickAway={handleClickAwaySearch}\r\n            />\r\n            <FormControlLabel\r\n              control={<Checkbox checked={onlyUnreadShow} onChange={handleUnreadShowChange} />}\r\n              label=\"display unread chat partner only\"\r\n            />\r\n          </Box>\r\n        )}\r\n      </Box>\r\n\r\n      <Scrollbar>\r\n        {/* {!displayResults ? ( */}\r\n        <ChatConversationList\r\n          conversations={conversations}\r\n          isOpenSidebar={openSidebar}\r\n          activeConversationId={activeConversationId}\r\n          // sx={{ ...(isSearchFocused && { display: 'none' }) }}\r\n          query={searchQuery}\r\n          onlyUnreadShow={onlyUnreadShow}\r\n        />\r\n        {/* ) : (\r\n          <ChatSearchResults query={searchQuery} results={searchResults} onSelectContact={handleSelectContact} />\r\n        )} */}\r\n      </Scrollbar>\r\n    </RootStyle>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}