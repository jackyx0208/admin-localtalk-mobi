{"ast":null,"code":"import _regeneratorRuntime from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{sum,map,filter,uniqBy,reject}from'lodash';import{createSlice}from'@reduxjs/toolkit';// utils\nimport axios from'../../utils/axios';// ----------------------------------------------------------------------\nvar initialState={isLoading:false,error:false,products:[],product:null,sortBy:null,filters:{gender:[],category:'All',colors:[],priceRange:'',rating:''},checkout:{activeStep:0,cart:[],subtotal:0,total:0,discount:0,shipping:0,billing:null}};var slice=createSlice({name:'product',initialState:initialState,reducers:{// START LOADING\nstartLoading:function startLoading(state){state.isLoading=true;},// HAS ERROR\nhasError:function hasError(state,action){state.isLoading=false;state.error=action.payload;},// GET PRODUCTS\ngetProductsSuccess:function getProductsSuccess(state,action){state.isLoading=false;state.products=action.payload;},// GET PRODUCT\ngetProductSuccess:function getProductSuccess(state,action){state.isLoading=false;state.product=action.payload;},// DELETE PRODUCT\ndeleteProduct:function deleteProduct(state,action){state.products=reject(state.products,{id:action.payload});},//  SORT & FILTER PRODUCTS\nsortByProducts:function sortByProducts(state,action){state.sortBy=action.payload;},filterProducts:function filterProducts(state,action){state.filters.gender=action.payload.gender;state.filters.category=action.payload.category;state.filters.colors=action.payload.colors;state.filters.priceRange=action.payload.priceRange;state.filters.rating=action.payload.rating;},// CHECKOUT\ngetCart:function getCart(state,action){var cart=action.payload;var subtotal=sum(cart.map(function(product){return product.price*product.quantity;}));var discount=cart.length===0?0:state.checkout.discount;var shipping=cart.length===0?0:state.checkout.shipping;var billing=cart.length===0?null:state.checkout.billing;state.checkout.cart=cart;state.checkout.discount=discount;state.checkout.shipping=shipping;state.checkout.billing=billing;state.checkout.subtotal=subtotal;state.checkout.total=subtotal-discount;},addCart:function addCart(state,action){var product=action.payload;var isEmptyCart=state.checkout.cart.length===0;if(isEmptyCart){state.checkout.cart=[].concat(_toConsumableArray(state.checkout.cart),[product]);}else{state.checkout.cart=map(state.checkout.cart,function(_product){var isExisted=_product.id===product.id;if(isExisted){return _objectSpread(_objectSpread({},_product),{},{quantity:_product.quantity+1});}return _product;});}state.checkout.cart=uniqBy([].concat(_toConsumableArray(state.checkout.cart),[product]),'id');},deleteCart:function deleteCart(state,action){var updateCart=filter(state.checkout.cart,function(item){return item.id!==action.payload;});state.checkout.cart=updateCart;},resetCart:function resetCart(state){state.checkout.activeStep=0;state.checkout.cart=[];state.checkout.total=0;state.checkout.subtotal=0;state.checkout.discount=0;state.checkout.shipping=0;state.checkout.billing=null;},onBackStep:function onBackStep(state){state.checkout.activeStep-=1;},onNextStep:function onNextStep(state){state.checkout.activeStep+=1;},onGotoStep:function onGotoStep(state,action){var goToStep=action.payload;state.checkout.activeStep=goToStep;},increaseQuantity:function increaseQuantity(state,action){var productId=action.payload;var updateCart=map(state.checkout.cart,function(product){if(product.id===productId){return _objectSpread(_objectSpread({},product),{},{quantity:product.quantity+1});}return product;});state.checkout.cart=updateCart;},decreaseQuantity:function decreaseQuantity(state,action){var productId=action.payload;var updateCart=map(state.checkout.cart,function(product){if(product.id===productId){return _objectSpread(_objectSpread({},product),{},{quantity:product.quantity-1});}return product;});state.checkout.cart=updateCart;},createBilling:function createBilling(state,action){state.checkout.billing=action.payload;},applyDiscount:function applyDiscount(state,action){var discount=action.payload;state.checkout.discount=discount;state.checkout.total=state.checkout.subtotal-discount;},applyShipping:function applyShipping(state,action){var shipping=action.payload;state.checkout.shipping=shipping;state.checkout.total=state.checkout.subtotal-state.checkout.discount+shipping;}}});// Reducer\nexport default slice.reducer;// Actions\nvar _slice$actions=slice.actions,getCart=_slice$actions.getCart,addCart=_slice$actions.addCart,resetCart=_slice$actions.resetCart,onGotoStep=_slice$actions.onGotoStep,onBackStep=_slice$actions.onBackStep,onNextStep=_slice$actions.onNextStep,deleteCart=_slice$actions.deleteCart,deleteProduct=_slice$actions.deleteProduct,createBilling=_slice$actions.createBilling,applyShipping=_slice$actions.applyShipping,applyDiscount=_slice$actions.applyDiscount,filterProducts=_slice$actions.filterProducts,sortByProducts=_slice$actions.sortByProducts,increaseQuantity=_slice$actions.increaseQuantity,decreaseQuantity=_slice$actions.decreaseQuantity;// ----------------------------------------------------------------------\nexport{getCart,addCart,resetCart,onGotoStep,onBackStep,onNextStep,deleteCart,deleteProduct,createBilling,applyShipping,applyDiscount,filterProducts,sortByProducts,increaseQuantity,decreaseQuantity};export function getProducts(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(slice.actions.startLoading());_context.prev=1;_context.next=4;return axios.get('/api/products');case 4:response=_context.sent;dispatch(slice.actions.getProductsSuccess(response.data.products));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch(slice.actions.hasError(_context.t0));case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();}// ----------------------------------------------------------------------\nexport function getProduct(name){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(slice.actions.startLoading());_context2.prev=1;_context2.next=4;return axios.get('/api/products/product',{params:{name:name}});case 4:response=_context2.sent;dispatch(slice.actions.getProductSuccess(response.data.product));_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);console.error(_context2.t0);dispatch(slice.actions.hasError(_context2.t0));case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();}","map":{"version":3,"sources":["E:/projects/localtalk.mobi/mobilechat-adminpanel/src/redux/slices/product.js"],"names":["sum","map","filter","uniqBy","reject","createSlice","axios","initialState","isLoading","error","products","product","sortBy","filters","gender","category","colors","priceRange","rating","checkout","activeStep","cart","subtotal","total","discount","shipping","billing","slice","name","reducers","startLoading","state","hasError","action","payload","getProductsSuccess","getProductSuccess","deleteProduct","id","sortByProducts","filterProducts","getCart","price","quantity","length","addCart","isEmptyCart","_product","isExisted","deleteCart","updateCart","item","resetCart","onBackStep","onNextStep","onGotoStep","goToStep","increaseQuantity","productId","decreaseQuantity","createBilling","applyDiscount","applyShipping","reducer","actions","getProducts","dispatch","get","response","data","getProduct","params","console"],"mappings":"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","sourcesContent":["import { sum, map, filter, uniqBy, reject } from 'lodash';\r\nimport { createSlice } from '@reduxjs/toolkit';\r\n// utils\r\nimport axios from '../../utils/axios';\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nconst initialState = {\r\n  isLoading: false,\r\n  error: false,\r\n  products: [],\r\n  product: null,\r\n  sortBy: null,\r\n  filters: {\r\n    gender: [],\r\n    category: 'All',\r\n    colors: [],\r\n    priceRange: '',\r\n    rating: ''\r\n  },\r\n  checkout: {\r\n    activeStep: 0,\r\n    cart: [],\r\n    subtotal: 0,\r\n    total: 0,\r\n    discount: 0,\r\n    shipping: 0,\r\n    billing: null\r\n  }\r\n};\r\n\r\nconst slice = createSlice({\r\n  name: 'product',\r\n  initialState,\r\n  reducers: {\r\n    // START LOADING\r\n    startLoading(state) {\r\n      state.isLoading = true;\r\n    },\r\n\r\n    // HAS ERROR\r\n    hasError(state, action) {\r\n      state.isLoading = false;\r\n      state.error = action.payload;\r\n    },\r\n\r\n    // GET PRODUCTS\r\n    getProductsSuccess(state, action) {\r\n      state.isLoading = false;\r\n      state.products = action.payload;\r\n    },\r\n\r\n    // GET PRODUCT\r\n    getProductSuccess(state, action) {\r\n      state.isLoading = false;\r\n      state.product = action.payload;\r\n    },\r\n\r\n    // DELETE PRODUCT\r\n    deleteProduct(state, action) {\r\n      state.products = reject(state.products, { id: action.payload });\r\n    },\r\n\r\n    //  SORT & FILTER PRODUCTS\r\n    sortByProducts(state, action) {\r\n      state.sortBy = action.payload;\r\n    },\r\n\r\n    filterProducts(state, action) {\r\n      state.filters.gender = action.payload.gender;\r\n      state.filters.category = action.payload.category;\r\n      state.filters.colors = action.payload.colors;\r\n      state.filters.priceRange = action.payload.priceRange;\r\n      state.filters.rating = action.payload.rating;\r\n    },\r\n\r\n    // CHECKOUT\r\n    getCart(state, action) {\r\n      const cart = action.payload;\r\n\r\n      const subtotal = sum(cart.map((product) => product.price * product.quantity));\r\n      const discount = cart.length === 0 ? 0 : state.checkout.discount;\r\n      const shipping = cart.length === 0 ? 0 : state.checkout.shipping;\r\n      const billing = cart.length === 0 ? null : state.checkout.billing;\r\n\r\n      state.checkout.cart = cart;\r\n      state.checkout.discount = discount;\r\n      state.checkout.shipping = shipping;\r\n      state.checkout.billing = billing;\r\n      state.checkout.subtotal = subtotal;\r\n      state.checkout.total = subtotal - discount;\r\n    },\r\n\r\n    addCart(state, action) {\r\n      const product = action.payload;\r\n      const isEmptyCart = state.checkout.cart.length === 0;\r\n\r\n      if (isEmptyCart) {\r\n        state.checkout.cart = [...state.checkout.cart, product];\r\n      } else {\r\n        state.checkout.cart = map(state.checkout.cart, (_product) => {\r\n          const isExisted = _product.id === product.id;\r\n          if (isExisted) {\r\n            return {\r\n              ..._product,\r\n              quantity: _product.quantity + 1\r\n            };\r\n          }\r\n          return _product;\r\n        });\r\n      }\r\n      state.checkout.cart = uniqBy([...state.checkout.cart, product], 'id');\r\n    },\r\n\r\n    deleteCart(state, action) {\r\n      const updateCart = filter(state.checkout.cart, (item) => item.id !== action.payload);\r\n\r\n      state.checkout.cart = updateCart;\r\n    },\r\n\r\n    resetCart(state) {\r\n      state.checkout.activeStep = 0;\r\n      state.checkout.cart = [];\r\n      state.checkout.total = 0;\r\n      state.checkout.subtotal = 0;\r\n      state.checkout.discount = 0;\r\n      state.checkout.shipping = 0;\r\n      state.checkout.billing = null;\r\n    },\r\n\r\n    onBackStep(state) {\r\n      state.checkout.activeStep -= 1;\r\n    },\r\n\r\n    onNextStep(state) {\r\n      state.checkout.activeStep += 1;\r\n    },\r\n\r\n    onGotoStep(state, action) {\r\n      const goToStep = action.payload;\r\n      state.checkout.activeStep = goToStep;\r\n    },\r\n\r\n    increaseQuantity(state, action) {\r\n      const productId = action.payload;\r\n      const updateCart = map(state.checkout.cart, (product) => {\r\n        if (product.id === productId) {\r\n          return {\r\n            ...product,\r\n            quantity: product.quantity + 1\r\n          };\r\n        }\r\n        return product;\r\n      });\r\n\r\n      state.checkout.cart = updateCart;\r\n    },\r\n\r\n    decreaseQuantity(state, action) {\r\n      const productId = action.payload;\r\n      const updateCart = map(state.checkout.cart, (product) => {\r\n        if (product.id === productId) {\r\n          return {\r\n            ...product,\r\n            quantity: product.quantity - 1\r\n          };\r\n        }\r\n        return product;\r\n      });\r\n\r\n      state.checkout.cart = updateCart;\r\n    },\r\n\r\n    createBilling(state, action) {\r\n      state.checkout.billing = action.payload;\r\n    },\r\n\r\n    applyDiscount(state, action) {\r\n      const discount = action.payload;\r\n      state.checkout.discount = discount;\r\n      state.checkout.total = state.checkout.subtotal - discount;\r\n    },\r\n\r\n    applyShipping(state, action) {\r\n      const shipping = action.payload;\r\n      state.checkout.shipping = shipping;\r\n      state.checkout.total = state.checkout.subtotal - state.checkout.discount + shipping;\r\n    }\r\n  }\r\n});\r\n\r\n// Reducer\r\nexport default slice.reducer;\r\n\r\n// Actions\r\nexport const {\r\n  getCart,\r\n  addCart,\r\n  resetCart,\r\n  onGotoStep,\r\n  onBackStep,\r\n  onNextStep,\r\n  deleteCart,\r\n  deleteProduct,\r\n  createBilling,\r\n  applyShipping,\r\n  applyDiscount,\r\n  filterProducts,\r\n  sortByProducts,\r\n  increaseQuantity,\r\n  decreaseQuantity\r\n} = slice.actions;\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nexport function getProducts() {\r\n  return async (dispatch) => {\r\n    dispatch(slice.actions.startLoading());\r\n    try {\r\n      const response = await axios.get('/api/products');\r\n      dispatch(slice.actions.getProductsSuccess(response.data.products));\r\n    } catch (error) {\r\n      dispatch(slice.actions.hasError(error));\r\n    }\r\n  };\r\n}\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nexport function getProduct(name) {\r\n  return async (dispatch) => {\r\n    dispatch(slice.actions.startLoading());\r\n    try {\r\n      const response = await axios.get('/api/products/product', {\r\n        params: { name }\r\n      });\r\n      dispatch(slice.actions.getProductSuccess(response.data.product));\r\n    } catch (error) {\r\n      console.error(error);\r\n      dispatch(slice.actions.hasError(error));\r\n    }\r\n  };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}