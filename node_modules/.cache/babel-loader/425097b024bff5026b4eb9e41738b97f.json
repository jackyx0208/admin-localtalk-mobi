{"ast":null,"code":"import _slicedToArray from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{filter}from'lodash';import{Icon}from'@iconify/react';// import { sentenceCase } from 'change-case';\nimport{useState,useEffect}from'react';// import closeSquareFill from '@iconify/icons-eva/close-square-fill';\nimport closeSquareOutline from'@iconify/icons-eva/close-square-outline';// import plusFill from '@iconify/icons-eva/plus-fill';\nimport downloadOutline from'@iconify/icons-eva/download-outline';// import FileDownloadIcon from '@mui/icons-material/FileDownload';\n// import { Link as RouterLink } from 'react-router-dom';\n// import axios from 'axios';\nimport{useSnackbar}from'notistack5';// material\nimport{useTheme}from'@material-ui/core/styles';import{Card,Table,Stack,Avatar,Button,Checkbox,TableRow,TableBody,TableCell,Container,Typography,TableContainer,TablePagination}from'@material-ui/core';import emailjs from'emailjs-com';// redux\nimport{useDispatch,useSelector}from'../../redux/store';import{getSettingsList}from'../../redux/slices/settings';import{getUserList}from'../../redux/slices/user';// routes\nimport{PATH_DASHBOARD}from'../../routes/paths';// hooks\nimport useSettings from'../../hooks/useSettings';import useAuth from'../../hooks/useAuth';// components\nimport Page from'../../components/Page';import Label from'../../components/Label';import Scrollbar from'../../components/Scrollbar';import SearchNotFound from'../../components/SearchNotFound';import HeaderBreadcrumbs from'../../components/HeaderBreadcrumbs';import{MailListHead,MailListToolbar}from'../../components/_dashboard/mail/list';import MailSendMessageDialog from'../../components/_dashboard/mail/MailSendMessageDialog';// ----------------------------------------------------------------------\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TABLE_HEAD=[{id:'email',label:'Mail',alignRight:false},{id:'address',label:'Location',alignRight:false},{id:'coverage',label:'Coverage',alignRight:false},{id:'balance',label:'Balance',alignRight:false},{id:'credit',label:'Credit %',alignRight:false},{id:''}];// ----------------------------------------------------------------------\nfunction descendingComparator(a,b,orderBy){if(b[orderBy]<a[orderBy]){return-1;}if(b[orderBy]>a[orderBy]){return 1;}return 0;}function getComparator(order,orderBy){return order==='desc'?function(a,b){return descendingComparator(a,b,orderBy);}:function(a,b){return-descendingComparator(a,b,orderBy);};}function applySortFilter(array,comparator,query){var stabilizedThis=array.map(function(el,index){return[el,index];});stabilizedThis.sort(function(a,b){var order=comparator(a[0],b[0]);if(order!==0)return order;return a[1]-b[1];});if(query){array=stabilizedThis.map(function(el){return el[0];});return filter(array,function(_user){if(_user.role==='admin'){return false;}if(query.deletedUsers&&query.deletedUsers.indexOf(_user._id)>-1){return false;}if(query.filterLocation&&_user.address.toLowerCase().indexOf(query.filterLocation.toLowerCase())===-1){return false;}if(Number(query.filterCoverage)>0&&_user.coverage<query.filterCoverage){return false;}if(Number(query.filterBalance)>0&&_user.balance<query.filterBalance){return false;}if(Number(query.filterCredit)>0&&_user.credit<query.filterCredit){return false;}return true;});}return stabilizedThis.map(function(el){return el[0];});}export default function MailList(){var _useSettings=useSettings(),themeStretch=_useSettings.themeStretch;var theme=useTheme();var dispatch=useDispatch();var _useAuth=useAuth(),user=_useAuth.user,logout=_useAuth.logout;var _useSelector=useSelector(function(state){return state.user;}),userList=_useSelector.userList;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),page=_useState2[0],setPage=_useState2[1];var _useState3=useState('asc'),_useState4=_slicedToArray(_useState3,2),order=_useState4[0],setOrder=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),selected=_useState6[0],setSelected=_useState6[1];var _useState7=useState('email'),_useState8=_slicedToArray(_useState7,2),orderBy=_useState8[0],setOrderBy=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),filterLocation=_useState10[0],setFilterLocation=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),filterCoverage=_useState12[0],setFilterCoverage=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),filterBalance=_useState14[0],setFilterBalance=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),filterCredit=_useState16[0],setFilterCredit=_useState16[1];var _useState17=useState(localStorage.getItem('maillist_rows_per_page')?Number(localStorage.getItem('maillist_rows_per_page')):25),_useState18=_slicedToArray(_useState17,2),rowsPerPage=_useState18[0],setRowsPerPage=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),deletedUsers=_useState20[0],setDeletedUsers=_useState20[1];var _useSelector2=useSelector(function(state){return state.setting;}),settingsList=_useSelector2.settingsList;var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),openMessageDialog=_useState22[0],setOpenMessageDialog=_useState22[1];var _useState23=useState(''),_useState24=_slicedToArray(_useState23,2),message=_useState24[0],setMessage=_useState24[1];var _useState25=useState(''),_useState26=_slicedToArray(_useState25,2),handleMailAddress=_useState26[0],setHandleMailAddress=_useState26[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var emptyRows=page>0?Math.max(0,(1+page)*rowsPerPage-userList.length):0;console.log('rendering');var filteredUsers=applySortFilter(userList,getComparator(order,orderBy),{deletedUsers:deletedUsers,filterLocation:filterLocation,filterCoverage:filterCoverage,filterBalance:filterBalance,filterCredit:filterCredit});var isUserNotFound=filteredUsers.length===0;useEffect(function(){dispatch(getUserList());dispatch(getSettingsList());},[dispatch]);var handleCloseSendMsgDlg=function handleCloseSendMsgDlg(){setOpenMessageDialog(false);};var handleMessage=function handleMessage(event){setMessage(event.target.value);};var handleSendMsg=function handleSendMsg(e){// console.log(message, handleMailAddress, e);\nsetOpenMessageDialog(false);e.preventDefault();emailjs.sendForm('service_wn9lisb','template_m65qsyc',e.target,'user_MxzB0RTW3TNvE5j2yxcMi').then(function(result){console.log(result);enqueueSnackbar('Send Message Successfully',{variant:'success'});},function(error){enqueueSnackbar(error.text,{variant:'error'});console.log(error.text);});};var handleSendMessage=function handleSendMessage(email){setMessage('');setHandleMailAddress(email);setOpenMessageDialog(true);};var handleRequestSort=function handleRequestSort(event,property){var isAsc=orderBy===property&&order==='asc';setOrder(isAsc?'desc':'asc');setOrderBy(property);};var handleSelectAllClick=function handleSelectAllClick(event){if(event.target.checked){var newSelecteds=userList.map(function(n){return n.name;});setSelected(newSelecteds);return;}setSelected([]);};var handleClick=function handleClick(event,name){var selectedIndex=selected.indexOf(name);var newSelected=[];if(selectedIndex===-1){newSelected=newSelected.concat(selected,name);}else if(selectedIndex===0){newSelected=newSelected.concat(selected.slice(1));}else if(selectedIndex===selected.length-1){newSelected=newSelected.concat(selected.slice(0,-1));}else if(selectedIndex>0){newSelected=newSelected.concat(selected.slice(0,selectedIndex),selected.slice(selectedIndex+1));}setSelected(newSelected);};var handleChangePage=function handleChangePage(event,newPage){setPage(newPage);};var handleChangeRowsPerPage=function handleChangeRowsPerPage(event){setRowsPerPage(parseInt(event.target.value,10));localStorage.setItem('maillist_rows_per_page',parseInt(event.target.value,10));setPage(0);};var handleFilterByLocation=function handleFilterByLocation(event){setFilterLocation(event.target.value);};var handleFilterByCoverage=function handleFilterByCoverage(event){setFilterCoverage(event.target.value);};var handleFilterByBalance=function handleFilterByBalance(event){setFilterBalance(event.target.value);};var handleFilterByCredit=function handleFilterByCredit(event){setFilterCredit(event.target.value);};var handleDownloadEmails=function handleDownloadEmails(){console.log('handle download emails');var element=document.createElement('a');var emailList=filteredUsers.map(function(user){return\"\".concat(user.email,\"\\r\\n\");});// console.log(emailList);\nvar file=new Blob(emailList,{type:'text/plain'});element.href=URL.createObjectURL(file);element.download=\"email_list_\".concat(Date.now(),\".txt\");document.body.appendChild(element);// Required for this to work in FireFox\n// element.addEventListener('click', (e) => {\n//   setTimeout(() => URL.revokeObjectURL(element.href), 30 * 1000);\n// });\nelement.click();};var handleDeleteRow=function handleDeleteRow(userId,email){// console.log(userId);\nvar deletedIds=deletedUsers;if(deletedIds.indexOf(userId)===-1){// console.log(deletedIds, userId);\ndeletedIds.push(userId);}setDeletedUsers(deletedIds);setHandleMailAddress(email);};return/*#__PURE__*/_jsx(Page,{title:\"Mail: List | Locals\",children:/*#__PURE__*/_jsxs(Container,{maxWidth:themeStretch?false:'lg',children:[/*#__PURE__*/_jsx(HeaderBreadcrumbs,{heading:\"Mail List\",links:[{name:'Dashboard',href:PATH_DASHBOARD.root},{name:'MailList'}],action:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){handleDownloadEmails();},startIcon:/*#__PURE__*/_jsx(Icon,{icon:downloadOutline}),children:\"Export Email List\"})}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(MailListToolbar,{numSelected:selected.length,filterLocation:filterLocation,onFilterLocation:handleFilterByLocation,filterCoverage:filterCoverage,onFilterCoverage:handleFilterByCoverage,filterBalance:filterBalance,onFilterBalance:handleFilterByBalance,filterCredit:filterCredit,onFilterCredit:handleFilterByCredit}),/*#__PURE__*/_jsx(Scrollbar,{children:/*#__PURE__*/_jsx(TableContainer,{sx:{minWidth:800},children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(MailListHead,{order:order,orderBy:orderBy,headLabel:TABLE_HEAD,rowCount:userList.length,numSelected:selected.length,onRequestSort:handleRequestSort,onSelectAllClick:handleSelectAllClick}),/*#__PURE__*/_jsxs(TableBody,{children:[filteredUsers.slice(page*rowsPerPage,page*rowsPerPage+rowsPerPage).map(function(row){var _id=row._id,email=row.email,name=row.name,avatarUrl=row.avatarUrl,role=row.role,credit=row.credit,balance=row.balance,status=row.status,isVerified=row.isVerified,coverage=row.coverage,country=row.country,address=row.address,online=row.online;var isItemSelected=selected.indexOf(email)!==-1;return/*#__PURE__*/_jsxs(TableRow,{hover:true,tabIndex:-1// role=\"checkbox\"\n,selected:isItemSelected,\"aria-checked\":isItemSelected,children:[/*#__PURE__*/_jsx(TableCell,{component:\"td\",scope:\"row\",padding:\"none\",children:/*#__PURE__*/_jsx(Button,{variant:\"text\",onClick:function onClick(){handleDeleteRow(_id,email);},sx:{color:'text.secondary'},style:{minWidth:'unset',padding:'5px'},children:/*#__PURE__*/_jsx(Icon,{icon:closeSquareOutline,width:18,height:18})})}),/*#__PURE__*/_jsx(TableCell,{component:\"th\",scope:\"row\",padding:\"none\",children:/*#__PURE__*/_jsx(Stack,{direction:\"row\",alignItems:\"center\",spacing:2,children:/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",noWrap:true,children:email})})}),/*#__PURE__*/_jsx(TableCell,{component:\"td\",scope:\"row\",padding:\"none\",children:address}),/*#__PURE__*/_jsx(TableCell,{component:\"td\",scope:\"row\",padding:\"none\",align:\"left\",children:Math.floor(coverage)}),/*#__PURE__*/_jsx(TableCell,{component:\"td\",scope:\"row\",padding:\"none\",align:\"left\",children:balance}),/*#__PURE__*/_jsx(TableCell,{component:\"td\",scope:\"row\",padding:\"none\",align:\"left\",children:credit}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){handleSendMessage(email);},children:\"Send Message\"})})]},_id);}),emptyRows>0&&/*#__PURE__*/_jsx(TableRow,{style:{height:53*emptyRows},children:/*#__PURE__*/_jsx(TableCell,{colSpan:6})})]}),isUserNotFound&&/*#__PURE__*/_jsx(TableBody,{children:/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{align:\"center\",colSpan:6,sx:{py:3},children:/*#__PURE__*/_jsx(SearchNotFound,{searchQuery:\"\".concat(filterLocation,\", \").concat(filterCoverage,\", \").concat(filterBalance,\", \").concat(filterCredit)})})})})]})})}),/*#__PURE__*/_jsx(TablePagination,{rowsPerPageOptions:[25,50,100],component:\"div\",count:userList.length,rowsPerPage:rowsPerPage,page:page,onPageChange:handleChangePage,onRowsPerPageChange:handleChangeRowsPerPage})]}),openMessageDialog&&/*#__PURE__*/_jsx(MailSendMessageDialog,{mailAddress:handleMailAddress,message:message,onMessage:handleMessage,onSend:function onSend(e){return handleSendMsg(e);},onClose:handleCloseSendMsgDlg})]})});}","map":{"version":3,"sources":["E:/projects/localtalk.mobi/mobilechat-adminpanel/src/pages/dashboard/MailList.js"],"names":["filter","Icon","useState","useEffect","closeSquareOutline","downloadOutline","useSnackbar","useTheme","Card","Table","Stack","Avatar","Button","Checkbox","TableRow","TableBody","TableCell","Container","Typography","TableContainer","TablePagination","emailjs","useDispatch","useSelector","getSettingsList","getUserList","PATH_DASHBOARD","useSettings","useAuth","Page","Label","Scrollbar","SearchNotFound","HeaderBreadcrumbs","MailListHead","MailListToolbar","MailSendMessageDialog","TABLE_HEAD","id","label","alignRight","descendingComparator","a","b","orderBy","getComparator","order","applySortFilter","array","comparator","query","stabilizedThis","map","el","index","sort","_user","role","deletedUsers","indexOf","_id","filterLocation","address","toLowerCase","Number","filterCoverage","coverage","filterBalance","balance","filterCredit","credit","MailList","themeStretch","theme","dispatch","user","logout","state","userList","page","setPage","setOrder","selected","setSelected","setOrderBy","setFilterLocation","setFilterCoverage","setFilterBalance","setFilterCredit","localStorage","getItem","rowsPerPage","setRowsPerPage","setDeletedUsers","setting","settingsList","openMessageDialog","setOpenMessageDialog","message","setMessage","handleMailAddress","setHandleMailAddress","enqueueSnackbar","emptyRows","Math","max","length","console","log","filteredUsers","isUserNotFound","handleCloseSendMsgDlg","handleMessage","event","target","value","handleSendMsg","e","preventDefault","sendForm","then","result","variant","error","text","handleSendMessage","email","handleRequestSort","property","isAsc","handleSelectAllClick","checked","newSelecteds","n","name","handleClick","selectedIndex","newSelected","concat","slice","handleChangePage","newPage","handleChangeRowsPerPage","parseInt","setItem","handleFilterByLocation","handleFilterByCoverage","handleFilterByBalance","handleFilterByCredit","handleDownloadEmails","element","document","createElement","emailList","file","Blob","type","href","URL","createObjectURL","download","Date","now","body","appendChild","click","handleDeleteRow","userId","deletedIds","push","root","minWidth","row","avatarUrl","status","isVerified","country","online","isItemSelected","color","padding","floor","height","py"],"mappings":"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","sourcesContent":["import { filter } from 'lodash';\r\nimport { Icon } from '@iconify/react';\r\n// import { sentenceCase } from 'change-case';\r\nimport { useState, useEffect } from 'react';\r\n// import closeSquareFill from '@iconify/icons-eva/close-square-fill';\r\nimport closeSquareOutline from '@iconify/icons-eva/close-square-outline';\r\n// import plusFill from '@iconify/icons-eva/plus-fill';\r\nimport downloadOutline from '@iconify/icons-eva/download-outline';\r\n// import FileDownloadIcon from '@mui/icons-material/FileDownload';\r\n// import { Link as RouterLink } from 'react-router-dom';\r\n// import axios from 'axios';\r\nimport { useSnackbar } from 'notistack5';\r\n// material\r\nimport { useTheme } from '@material-ui/core/styles';\r\nimport {\r\n  Card,\r\n  Table,\r\n  Stack,\r\n  Avatar,\r\n  Button,\r\n  Checkbox,\r\n  TableRow,\r\n  TableBody,\r\n  TableCell,\r\n  Container,\r\n  Typography,\r\n  TableContainer,\r\n  TablePagination\r\n} from '@material-ui/core';\r\nimport emailjs from 'emailjs-com';\r\n// redux\r\nimport { useDispatch, useSelector } from '../../redux/store';\r\nimport { getSettingsList } from '../../redux/slices/settings';\r\nimport { getUserList } from '../../redux/slices/user';\r\n// routes\r\nimport { PATH_DASHBOARD } from '../../routes/paths';\r\n// hooks\r\nimport useSettings from '../../hooks/useSettings';\r\nimport useAuth from '../../hooks/useAuth';\r\n// components\r\nimport Page from '../../components/Page';\r\nimport Label from '../../components/Label';\r\nimport Scrollbar from '../../components/Scrollbar';\r\nimport SearchNotFound from '../../components/SearchNotFound';\r\nimport HeaderBreadcrumbs from '../../components/HeaderBreadcrumbs';\r\nimport { MailListHead, MailListToolbar } from '../../components/_dashboard/mail/list';\r\nimport MailSendMessageDialog from '../../components/_dashboard/mail/MailSendMessageDialog';\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nconst TABLE_HEAD = [\r\n  { id: 'email', label: 'Mail', alignRight: false },\r\n  { id: 'address', label: 'Location', alignRight: false },\r\n  { id: 'coverage', label: 'Coverage', alignRight: false },\r\n  { id: 'balance', label: 'Balance', alignRight: false },\r\n  { id: 'credit', label: 'Credit %', alignRight: false },\r\n  { id: '' }\r\n];\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nfunction descendingComparator(a, b, orderBy) {\r\n  if (b[orderBy] < a[orderBy]) {\r\n    return -1;\r\n  }\r\n  if (b[orderBy] > a[orderBy]) {\r\n    return 1;\r\n  }\r\n  return 0;\r\n}\r\n\r\nfunction getComparator(order, orderBy) {\r\n  return order === 'desc'\r\n    ? (a, b) => descendingComparator(a, b, orderBy)\r\n    : (a, b) => -descendingComparator(a, b, orderBy);\r\n}\r\n\r\nfunction applySortFilter(array, comparator, query) {\r\n  const stabilizedThis = array.map((el, index) => [el, index]);\r\n  stabilizedThis.sort((a, b) => {\r\n    const order = comparator(a[0], b[0]);\r\n    if (order !== 0) return order;\r\n    return a[1] - b[1];\r\n  });\r\n  if (query) {\r\n    array = stabilizedThis.map((el) => el[0]);\r\n    return filter(array, (_user) => {\r\n      if (_user.role === 'admin') {\r\n        return false;\r\n      }\r\n      if (query.deletedUsers && query.deletedUsers.indexOf(_user._id) > -1) {\r\n        return false;\r\n      }\r\n      if (query.filterLocation && _user.address.toLowerCase().indexOf(query.filterLocation.toLowerCase()) === -1) {\r\n        return false;\r\n      }\r\n      if (Number(query.filterCoverage) > 0 && _user.coverage < query.filterCoverage) {\r\n        return false;\r\n      }\r\n      if (Number(query.filterBalance) > 0 && _user.balance < query.filterBalance) {\r\n        return false;\r\n      }\r\n      if (Number(query.filterCredit) > 0 && _user.credit < query.filterCredit) {\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n  }\r\n  return stabilizedThis.map((el) => el[0]);\r\n}\r\n\r\nexport default function MailList() {\r\n  const { themeStretch } = useSettings();\r\n  const theme = useTheme();\r\n  const dispatch = useDispatch();\r\n  const { user, logout } = useAuth();\r\n  const { userList } = useSelector((state) => state.user);\r\n  const [page, setPage] = useState(0);\r\n  const [order, setOrder] = useState('asc');\r\n  const [selected, setSelected] = useState([]);\r\n  const [orderBy, setOrderBy] = useState('email');\r\n  const [filterLocation, setFilterLocation] = useState('');\r\n  const [filterCoverage, setFilterCoverage] = useState('');\r\n  const [filterBalance, setFilterBalance] = useState('');\r\n  const [filterCredit, setFilterCredit] = useState('');\r\n  const [rowsPerPage, setRowsPerPage] = useState(\r\n    localStorage.getItem('maillist_rows_per_page') ? Number(localStorage.getItem('maillist_rows_per_page')) : 25\r\n  );\r\n  const [deletedUsers, setDeletedUsers] = useState([]);\r\n  const { settingsList } = useSelector((state) => state.setting);\r\n  const [openMessageDialog, setOpenMessageDialog] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n  const [handleMailAddress, setHandleMailAddress] = useState('');\r\n  const { enqueueSnackbar } = useSnackbar();\r\n\r\n  const emptyRows = page > 0 ? Math.max(0, (1 + page) * rowsPerPage - userList.length) : 0;\r\n\r\n  console.log('rendering');\r\n  const filteredUsers = applySortFilter(userList, getComparator(order, orderBy), {\r\n    deletedUsers,\r\n    filterLocation,\r\n    filterCoverage,\r\n    filterBalance,\r\n    filterCredit\r\n  });\r\n\r\n  const isUserNotFound = filteredUsers.length === 0;\r\n\r\n  useEffect(() => {\r\n    dispatch(getUserList());\r\n    dispatch(getSettingsList());\r\n  }, [dispatch]);\r\n\r\n  const handleCloseSendMsgDlg = () => {\r\n    setOpenMessageDialog(false);\r\n  };\r\n\r\n  const handleMessage = (event) => {\r\n    setMessage(event.target.value);\r\n  };\r\n\r\n  const handleSendMsg = (e) => {\r\n    // console.log(message, handleMailAddress, e);\r\n    setOpenMessageDialog(false);\r\n\r\n    e.preventDefault();\r\n\r\n    emailjs.sendForm('service_wn9lisb', 'template_m65qsyc', e.target, 'user_MxzB0RTW3TNvE5j2yxcMi').then(\r\n      (result) => {\r\n        console.log(result);\r\n        enqueueSnackbar('Send Message Successfully', { variant: 'success' });\r\n      },\r\n      (error) => {\r\n        enqueueSnackbar(error.text, { variant: 'error' });\r\n        console.log(error.text);\r\n      }\r\n    );\r\n  };\r\n\r\n  const handleSendMessage = (email) => {\r\n    setMessage('');\r\n    setHandleMailAddress(email);\r\n    setOpenMessageDialog(true);\r\n  };\r\n\r\n  const handleRequestSort = (event, property) => {\r\n    const isAsc = orderBy === property && order === 'asc';\r\n    setOrder(isAsc ? 'desc' : 'asc');\r\n    setOrderBy(property);\r\n  };\r\n\r\n  const handleSelectAllClick = (event) => {\r\n    if (event.target.checked) {\r\n      const newSelecteds = userList.map((n) => n.name);\r\n      setSelected(newSelecteds);\r\n      return;\r\n    }\r\n    setSelected([]);\r\n  };\r\n\r\n  const handleClick = (event, name) => {\r\n    const selectedIndex = selected.indexOf(name);\r\n    let newSelected = [];\r\n    if (selectedIndex === -1) {\r\n      newSelected = newSelected.concat(selected, name);\r\n    } else if (selectedIndex === 0) {\r\n      newSelected = newSelected.concat(selected.slice(1));\r\n    } else if (selectedIndex === selected.length - 1) {\r\n      newSelected = newSelected.concat(selected.slice(0, -1));\r\n    } else if (selectedIndex > 0) {\r\n      newSelected = newSelected.concat(selected.slice(0, selectedIndex), selected.slice(selectedIndex + 1));\r\n    }\r\n    setSelected(newSelected);\r\n  };\r\n\r\n  const handleChangePage = (event, newPage) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = (event) => {\r\n    setRowsPerPage(parseInt(event.target.value, 10));\r\n    localStorage.setItem('maillist_rows_per_page', parseInt(event.target.value, 10));\r\n    setPage(0);\r\n  };\r\n\r\n  const handleFilterByLocation = (event) => {\r\n    setFilterLocation(event.target.value);\r\n  };\r\n\r\n  const handleFilterByCoverage = (event) => {\r\n    setFilterCoverage(event.target.value);\r\n  };\r\n\r\n  const handleFilterByBalance = (event) => {\r\n    setFilterBalance(event.target.value);\r\n  };\r\n\r\n  const handleFilterByCredit = (event) => {\r\n    setFilterCredit(event.target.value);\r\n  };\r\n\r\n  const handleDownloadEmails = () => {\r\n    console.log('handle download emails');\r\n    const element = document.createElement('a');\r\n    const emailList = filteredUsers.map((user) => `${user.email}\\r\\n`);\r\n    // console.log(emailList);\r\n    const file = new Blob(emailList, { type: 'text/plain' });\r\n    element.href = URL.createObjectURL(file);\r\n    element.download = `email_list_${Date.now()}.txt`;\r\n    document.body.appendChild(element); // Required for this to work in FireFox\r\n    // element.addEventListener('click', (e) => {\r\n    //   setTimeout(() => URL.revokeObjectURL(element.href), 30 * 1000);\r\n    // });\r\n    element.click();\r\n  };\r\n\r\n  const handleDeleteRow = (userId, email) => {\r\n    // console.log(userId);\r\n    const deletedIds = deletedUsers;\r\n    if (deletedIds.indexOf(userId) === -1) {\r\n      // console.log(deletedIds, userId);\r\n      deletedIds.push(userId);\r\n    }\r\n    setDeletedUsers(deletedIds);\r\n    setHandleMailAddress(email);\r\n  };\r\n\r\n  return (\r\n    <Page title=\"Mail: List | Locals\">\r\n      <Container maxWidth={themeStretch ? false : 'lg'}>\r\n        <HeaderBreadcrumbs\r\n          heading=\"Mail List\"\r\n          links={[{ name: 'Dashboard', href: PATH_DASHBOARD.root }, { name: 'MailList' }]}\r\n          action={\r\n            <Button\r\n              variant=\"contained\"\r\n              onClick={() => {\r\n                handleDownloadEmails();\r\n              }}\r\n              startIcon={<Icon icon={downloadOutline} />}\r\n            >\r\n              Export Email List\r\n            </Button>\r\n          }\r\n        />\r\n\r\n        <Card>\r\n          <MailListToolbar\r\n            numSelected={selected.length}\r\n            filterLocation={filterLocation}\r\n            onFilterLocation={handleFilterByLocation}\r\n            filterCoverage={filterCoverage}\r\n            onFilterCoverage={handleFilterByCoverage}\r\n            filterBalance={filterBalance}\r\n            onFilterBalance={handleFilterByBalance}\r\n            filterCredit={filterCredit}\r\n            onFilterCredit={handleFilterByCredit}\r\n          />\r\n\r\n          <Scrollbar>\r\n            <TableContainer sx={{ minWidth: 800 }}>\r\n              <Table>\r\n                <MailListHead\r\n                  order={order}\r\n                  orderBy={orderBy}\r\n                  headLabel={TABLE_HEAD}\r\n                  rowCount={userList.length}\r\n                  numSelected={selected.length}\r\n                  onRequestSort={handleRequestSort}\r\n                  onSelectAllClick={handleSelectAllClick}\r\n                />\r\n                <TableBody>\r\n                  {filteredUsers.slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage).map((row) => {\r\n                    const {\r\n                      _id,\r\n                      email,\r\n                      name,\r\n                      avatarUrl,\r\n                      role,\r\n                      credit,\r\n                      balance,\r\n                      status,\r\n                      isVerified,\r\n                      coverage,\r\n                      country,\r\n                      address,\r\n                      online\r\n                    } = row;\r\n                    const isItemSelected = selected.indexOf(email) !== -1;\r\n\r\n                    return (\r\n                      <TableRow\r\n                        hover\r\n                        key={_id}\r\n                        tabIndex={-1}\r\n                        // role=\"checkbox\"\r\n                        selected={isItemSelected}\r\n                        aria-checked={isItemSelected}\r\n                      >\r\n                        {/* <TableCell padding=\"checkbox\">\r\n                          <Checkbox checked={isItemSelected} onChange={(event) => handleClick(event, email)} />\r\n                        </TableCell> */}\r\n                        <TableCell component=\"td\" scope=\"row\" padding=\"none\">\r\n                          <Button\r\n                            variant=\"text\"\r\n                            onClick={() => {\r\n                              handleDeleteRow(_id, email);\r\n                            }}\r\n                            sx={{ color: 'text.secondary' }}\r\n                            style={{ minWidth: 'unset', padding: '5px' }}\r\n                          >\r\n                            <Icon icon={closeSquareOutline} width={18} height={18} />\r\n                          </Button>\r\n                        </TableCell>\r\n                        <TableCell component=\"th\" scope=\"row\" padding=\"none\">\r\n                          <Stack direction=\"row\" alignItems=\"center\" spacing={2}>\r\n                            <Typography variant=\"subtitle2\" noWrap>\r\n                              {email}\r\n                            </Typography>\r\n                          </Stack>\r\n                        </TableCell>\r\n                        <TableCell component=\"td\" scope=\"row\" padding=\"none\">\r\n                          {address}\r\n                        </TableCell>\r\n                        <TableCell component=\"td\" scope=\"row\" padding=\"none\" align=\"left\">\r\n                          {Math.floor(coverage)}\r\n                        </TableCell>\r\n                        <TableCell component=\"td\" scope=\"row\" padding=\"none\" align=\"left\">\r\n                          {balance}\r\n                        </TableCell>\r\n                        <TableCell component=\"td\" scope=\"row\" padding=\"none\" align=\"left\">\r\n                          {credit}\r\n                        </TableCell>\r\n                        <TableCell align=\"right\">\r\n                          <Button\r\n                            variant=\"contained\"\r\n                            onClick={() => {\r\n                              handleSendMessage(email);\r\n                            }}\r\n                          >\r\n                            Send Message\r\n                          </Button>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    );\r\n                  })}\r\n                  {emptyRows > 0 && (\r\n                    <TableRow style={{ height: 53 * emptyRows }}>\r\n                      <TableCell colSpan={6} />\r\n                    </TableRow>\r\n                  )}\r\n                </TableBody>\r\n                {isUserNotFound && (\r\n                  <TableBody>\r\n                    <TableRow>\r\n                      <TableCell align=\"center\" colSpan={6} sx={{ py: 3 }}>\r\n                        <SearchNotFound\r\n                          searchQuery={`${filterLocation}, ${filterCoverage}, ${filterBalance}, ${filterCredit}`}\r\n                        />\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  </TableBody>\r\n                )}\r\n              </Table>\r\n            </TableContainer>\r\n          </Scrollbar>\r\n\r\n          <TablePagination\r\n            rowsPerPageOptions={[25, 50, 100]}\r\n            component=\"div\"\r\n            count={userList.length}\r\n            rowsPerPage={rowsPerPage}\r\n            page={page}\r\n            onPageChange={handleChangePage}\r\n            onRowsPerPageChange={handleChangeRowsPerPage}\r\n          />\r\n        </Card>\r\n        {openMessageDialog && (\r\n          <MailSendMessageDialog\r\n            mailAddress={handleMailAddress}\r\n            message={message}\r\n            onMessage={handleMessage}\r\n            onSend={(e) => handleSendMsg(e)}\r\n            onClose={handleCloseSendMsgDlg}\r\n          />\r\n        )}\r\n      </Container>\r\n    </Page>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}