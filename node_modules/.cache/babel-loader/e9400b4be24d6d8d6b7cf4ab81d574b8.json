{"ast":null,"code":"import _objectSpread from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/projects/localtalk.mobi/mobilechat-adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import*as Yup from'yup';import{useState}from'react';import{useSnackbar}from'notistack5';import{useNavigate}from'react-router-dom';import{Form,FormikProvider,useFormik}from'formik';// material\nimport{LoadingButton}from'@material-ui/lab';import{Box,Card,Grid,Stack,Switch,TextField,Typography,FormHelperText,FormControlLabel}from'@material-ui/core';// import AdjustSharpIcon from '@mui/icons-material/AdjustSharp';\n// import AutoAwesomeSharpIcon from '@mui/icons-material/AutoAwesomeSharp';\n// utils\nimport axios from'../../../utils/axios';// import { fData } from '../../../utils/formatNumber';\nimport fakeRequest from'../../../utils/fakeRequest';// routes\nimport{PATH_DASHBOARD}from'../../../routes/paths';//\n// import Label from '../../Label';\n// import { UploadAvatar } from '../../upload';\nimport ConfirmDialog from'../../ConfirmDialog';// ----------------------------------------------------------------------\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function UserSpecialPermissionsForm(_ref){var readOnly=_ref.readOnly,currentUser=_ref.currentUser,userSpecialPermissions=_ref.userSpecialPermissions;var navigate=useNavigate();var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;readOnly=readOnly||false;// console.log(readOnly);\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),clearConfirm=_useState2[0],setClearConfirm=_useState2[1];var handleCloseClearConfirm=function handleCloseClearConfirm(){setClearConfirm(false);};var onClear=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setClearConfirm(true);case 1:case\"end\":return _context.stop();}}},_callee);}));return function onClear(){return _ref2.apply(this,arguments);};}();var handleClear=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post(\"user/clearSpecialPermission/\".concat(currentUser._id));case 2:navigate(PATH_DASHBOARD.user.list);enqueueSnackbar('Cleared User Special Permissions Successfully',{variant:'success'});case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function handleClear(){return _ref3.apply(this,arguments);};}();var itemValidation=Yup.object().shape({// user_email: Yup.string().required('This field is required'),\nmax_coverage:Yup.string().required('This field is required'),top_message_max_num:Yup.string().required('This field is required'),effect_year:Yup.string().required('This field is required'),effect_month:Yup.string().required('This field is required'),effect_day:Yup.string().required('This field is required'),valid_period:Yup.string().required('This field is required')});var formik=useFormik({enableReinitialize:true,initialValues:{// user_email: userSpecialPermissions?.user_email || '',\nmax_coverage:(userSpecialPermissions===null||userSpecialPermissions===void 0?void 0:userSpecialPermissions.max_coverage)||'',top_message_max_num:(userSpecialPermissions===null||userSpecialPermissions===void 0?void 0:userSpecialPermissions.top_message_max_num)||'',effect_year:(userSpecialPermissions===null||userSpecialPermissions===void 0?void 0:userSpecialPermissions.effect_year)||'',effect_month:(userSpecialPermissions===null||userSpecialPermissions===void 0?void 0:userSpecialPermissions.effect_month)||'',effect_day:(userSpecialPermissions===null||userSpecialPermissions===void 0?void 0:userSpecialPermissions.effect_day)||'',valid_period:(userSpecialPermissions===null||userSpecialPermissions===void 0?void 0:userSpecialPermissions.valid_period)||''},validationSchema:!readOnly?itemValidation:null,onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(values,_ref4){var setSubmitting,resetForm,setErrors;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setSubmitting=_ref4.setSubmitting,resetForm=_ref4.resetForm,setErrors=_ref4.setErrors;_context3.prev=1;_context3.next=4;return fakeRequest(500);case 4:_context3.next=6;return axios.put(\"/user/permissions/\".concat(currentUser._id),values);case 6:// resetForm();\nsetSubmitting(false);enqueueSnackbar('Update success',{variant:'success'});_context3.next=15;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](1);console.error(_context3.t0);setSubmitting(false);setErrors(_context3.t0);case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[1,10]]);}));function onSubmit(_x,_x2){return _onSubmit.apply(this,arguments);}return onSubmit;}()});var errors=formik.errors,values=formik.values,touched=formik.touched,handleSubmit=formik.handleSubmit,isSubmitting=formik.isSubmitting,setFieldValue=formik.setFieldValue,getFieldProps=formik.getFieldProps;return/*#__PURE__*/_jsxs(FormikProvider,{value:formik,children:[/*#__PURE__*/_jsx(Form,{noValidate:true,autoComplete:\"off\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:12,children:/*#__PURE__*/_jsxs(Card,{sx:{p:3,mt:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"inherit\",component:\"div\",sx:{mb:3},children:\"User Special Permission\"}),/*#__PURE__*/_jsxs(Stack,{spacing:3,children:[/*#__PURE__*/_jsxs(Stack,{direction:{xs:'column',sm:'row'},spacing:{xs:3,sm:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{lineHeight:2},children:\"Max Cover people\\xA0\\xA0\\xA0\"}),/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},getFieldProps('max_coverage')),{},{variant:\"standard\",inputProps:{readOnly:readOnly},style:{width:250},error:Boolean(touched.max_coverage&&errors.max_coverage),helperText:touched.max_coverage&&errors.max_coverage})),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{lineHeight:2},children:\"person (range 1 ~ 1,000,000)\"})]}),/*#__PURE__*/_jsxs(Stack,{direction:{xs:'column',sm:'row'},spacing:{xs:3,sm:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{lineHeight:2},children:\"TOP messages permission\\xA0\\xA0\\xA0\"}),/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},getFieldProps('top_message_max_num')),{},{variant:\"standard\",inputProps:{readOnly:readOnly},style:{width:150},error:Boolean(touched.top_message_max_num&&errors.top_message_max_num),helperText:touched.top_message_max_num&&errors.top_message_max_num})),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{lineHeight:2},children:\"(1 ~ 10)\"})]}),/*#__PURE__*/_jsxs(Stack,{direction:{xs:'column',sm:'row'},spacing:{xs:3,sm:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{lineHeight:2},children:\"Effective Time\\xA0\\xA0\\xA0\"}),/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},getFieldProps('effect_year')),{},{variant:\"standard\",inputProps:{readOnly:readOnly},style:{width:80},error:Boolean(touched.effect_year&&errors.effect_year),helperText:touched.effect_year&&errors.effect_year})),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{lineHeight:2},children:\"year\"}),/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},getFieldProps('effect_month')),{},{variant:\"standard\",inputProps:{readOnly:readOnly},style:{width:80},error:Boolean(touched.effect_month&&errors.effect_month),helperText:touched.effect_month&&errors.effect_month})),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{lineHeight:2},children:\"month\"}),/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},getFieldProps('effect_day')),{},{variant:\"standard\",inputProps:{readOnly:readOnly},style:{width:80},error:Boolean(touched.effect_day&&errors.effect_day),helperText:touched.effect_day&&errors.effect_day})),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{lineHeight:2},children:\"day (East America Time from 00:01 AM)\"})]}),/*#__PURE__*/_jsxs(Stack,{direction:{xs:'column',sm:'row'},spacing:{xs:3,sm:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{lineHeight:2},children:\"Permissions Valid period\\xA0\\xA0\\xA0\"}),/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},getFieldProps('valid_period')),{},{variant:\"standard\",inputProps:{readOnly:readOnly},style:{width:150},error:Boolean(touched.valid_period&&errors.valid_period),helperText:touched.valid_period&&errors.valid_period})),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{lineHeight:2},children:\"day\"})]}),!readOnly&&/*#__PURE__*/_jsx(Box,{sx:{mt:3,display:'flex',justifyContent:'flex-end'},children:/*#__PURE__*/_jsxs(Stack,{direction:{xs:'column',sm:'row'},spacing:{xs:3,sm:2},children:[userSpecialPermissions&&/*#__PURE__*/_jsx(LoadingButton,{type:\"button\",color:\"secondary\",variant:\"contained\",onClick:onClear,children:\"Clear Special Permissions\"}),/*#__PURE__*/_jsx(LoadingButton,{type:\"submit\",variant:\"contained\",loading:isSubmitting,children:\"Save Changes\"})]})})]})]})})})}),clearConfirm&&/*#__PURE__*/_jsx(ConfirmDialog,{message:\"Are you sure you are going to clear this user's special permission?\",onConfirm:handleClear,onClose:handleCloseClearConfirm})]});}","map":{"version":3,"sources":["E:/projects/localtalk.mobi/mobilechat-adminpanel/src/components/_dashboard/user/UserSpecialPermissionsForm.js"],"names":["Yup","useState","useSnackbar","useNavigate","Form","FormikProvider","useFormik","LoadingButton","Box","Card","Grid","Stack","Switch","TextField","Typography","FormHelperText","FormControlLabel","axios","fakeRequest","PATH_DASHBOARD","ConfirmDialog","UserSpecialPermissionsForm","readOnly","currentUser","userSpecialPermissions","navigate","enqueueSnackbar","clearConfirm","setClearConfirm","handleCloseClearConfirm","onClear","handleClear","post","_id","user","list","variant","itemValidation","object","shape","max_coverage","string","required","top_message_max_num","effect_year","effect_month","effect_day","valid_period","formik","enableReinitialize","initialValues","validationSchema","onSubmit","values","setSubmitting","resetForm","setErrors","put","console","error","errors","touched","handleSubmit","isSubmitting","setFieldValue","getFieldProps","p","mt","mb","xs","sm","lineHeight","width","Boolean","display","justifyContent"],"mappings":"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","sourcesContent":["import * as Yup from 'yup';\r\nimport PropTypes from 'prop-types';\r\nimport { useState } from 'react';\r\nimport { useSnackbar } from 'notistack5';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Form, FormikProvider, useFormik } from 'formik';\r\n// material\r\nimport { LoadingButton } from '@material-ui/lab';\r\nimport {\r\n  Box,\r\n  Card,\r\n  Grid,\r\n  Stack,\r\n  Switch,\r\n  TextField,\r\n  Typography,\r\n  FormHelperText,\r\n  FormControlLabel\r\n} from '@material-ui/core';\r\n// import AdjustSharpIcon from '@mui/icons-material/AdjustSharp';\r\n// import AutoAwesomeSharpIcon from '@mui/icons-material/AutoAwesomeSharp';\r\n// utils\r\nimport axios from '../../../utils/axios';\r\n// import { fData } from '../../../utils/formatNumber';\r\nimport fakeRequest from '../../../utils/fakeRequest';\r\n// routes\r\nimport { PATH_DASHBOARD } from '../../../routes/paths';\r\n//\r\n// import Label from '../../Label';\r\n// import { UploadAvatar } from '../../upload';\r\nimport ConfirmDialog from '../../ConfirmDialog';\r\n\r\n// ----------------------------------------------------------------------\r\n\r\nUserSpecialPermissionsForm.propTypes = {\r\n  readOnly: PropTypes.bool,\r\n  currentUser: PropTypes.object,\r\n  userSpecialPermissions: PropTypes.object\r\n};\r\n\r\nexport default function UserSpecialPermissionsForm({ readOnly, currentUser, userSpecialPermissions }) {\r\n  const navigate = useNavigate();\r\n  const { enqueueSnackbar } = useSnackbar();\r\n  readOnly = readOnly || false;\r\n  // console.log(readOnly);\r\n  const [clearConfirm, setClearConfirm] = useState(false);\r\n\r\n  const handleCloseClearConfirm = () => {\r\n    setClearConfirm(false);\r\n  };\r\n\r\n  const onClear = async () => {\r\n    setClearConfirm(true);\r\n  };\r\n\r\n  const handleClear = async () => {\r\n    await axios.post(`user/clearSpecialPermission/${currentUser._id}`);\r\n    navigate(PATH_DASHBOARD.user.list);\r\n    enqueueSnackbar('Cleared User Special Permissions Successfully', { variant: 'success' });\r\n  };\r\n\r\n  const itemValidation = Yup.object().shape({\r\n    // user_email: Yup.string().required('This field is required'),\r\n    max_coverage: Yup.string().required('This field is required'),\r\n    top_message_max_num: Yup.string().required('This field is required'),\r\n    effect_year: Yup.string().required('This field is required'),\r\n    effect_month: Yup.string().required('This field is required'),\r\n    effect_day: Yup.string().required('This field is required'),\r\n    valid_period: Yup.string().required('This field is required')\r\n  });\r\n\r\n  const formik = useFormik({\r\n    enableReinitialize: true,\r\n    initialValues: {\r\n      // user_email: userSpecialPermissions?.user_email || '',\r\n      max_coverage: userSpecialPermissions?.max_coverage || '',\r\n      top_message_max_num: userSpecialPermissions?.top_message_max_num || '',\r\n      effect_year: userSpecialPermissions?.effect_year || '',\r\n      effect_month: userSpecialPermissions?.effect_month || '',\r\n      effect_day: userSpecialPermissions?.effect_day || '',\r\n      valid_period: userSpecialPermissions?.valid_period || ''\r\n    },\r\n    validationSchema: !readOnly ? itemValidation : null,\r\n    onSubmit: async (values, { setSubmitting, resetForm, setErrors }) => {\r\n      try {\r\n        await fakeRequest(500);\r\n\r\n        await axios.put(`/user/permissions/${currentUser._id}`, values);\r\n\r\n        // resetForm();\r\n        setSubmitting(false);\r\n        enqueueSnackbar('Update success', { variant: 'success' });\r\n      } catch (error) {\r\n        console.error(error);\r\n        setSubmitting(false);\r\n        setErrors(error);\r\n      }\r\n    }\r\n  });\r\n\r\n  const { errors, values, touched, handleSubmit, isSubmitting, setFieldValue, getFieldProps } = formik;\r\n\r\n  return (\r\n    <FormikProvider value={formik}>\r\n      <Form noValidate autoComplete=\"off\" onSubmit={handleSubmit}>\r\n        <Grid container spacing={3}>\r\n          <Grid item xs={12} md={12}>\r\n            <Card sx={{ p: 3, mt: 3 }}>\r\n              <Typography variant=\"h6\" color=\"inherit\" component=\"div\" sx={{ mb: 3 }}>\r\n                User Special Permission\r\n              </Typography>\r\n              <Stack spacing={3}>\r\n                {/* <Stack direction={{ xs: 'column', sm: 'row' }} spacing={{ xs: 3, sm: 2 }}>\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    User Email&nbsp;&nbsp;&nbsp;\r\n                  </Typography>\r\n                  <TextField\r\n                    {...getFieldProps('user_email')}\r\n                    variant=\"standard\"\r\n                    style={{ width: 250 }}\r\n                    error={Boolean(touched.user_email && errors.user_email)}\r\n                    helperText={touched.user_email && errors.user_email}\r\n                  />\r\n                </Stack> */}\r\n\r\n                <Stack direction={{ xs: 'column', sm: 'row' }} spacing={{ xs: 3, sm: 2 }}>\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    Max Cover people&nbsp;&nbsp;&nbsp;\r\n                  </Typography>\r\n                  <TextField\r\n                    {...getFieldProps('max_coverage')}\r\n                    variant=\"standard\"\r\n                    inputProps={{ readOnly }}\r\n                    style={{ width: 250 }}\r\n                    error={Boolean(touched.max_coverage && errors.max_coverage)}\r\n                    helperText={touched.max_coverage && errors.max_coverage}\r\n                  />\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    person (range 1 ~ 1,000,000)\r\n                  </Typography>\r\n                </Stack>\r\n\r\n                <Stack direction={{ xs: 'column', sm: 'row' }} spacing={{ xs: 3, sm: 2 }}>\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    TOP messages permission&nbsp;&nbsp;&nbsp;\r\n                  </Typography>\r\n                  <TextField\r\n                    {...getFieldProps('top_message_max_num')}\r\n                    variant=\"standard\"\r\n                    inputProps={{ readOnly }}\r\n                    style={{ width: 150 }}\r\n                    error={Boolean(touched.top_message_max_num && errors.top_message_max_num)}\r\n                    helperText={touched.top_message_max_num && errors.top_message_max_num}\r\n                  />\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    (1 ~ 10)\r\n                  </Typography>\r\n                </Stack>\r\n\r\n                <Stack direction={{ xs: 'column', sm: 'row' }} spacing={{ xs: 3, sm: 2 }}>\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    Effective Time&nbsp;&nbsp;&nbsp;\r\n                  </Typography>\r\n                  <TextField\r\n                    {...getFieldProps('effect_year')}\r\n                    variant=\"standard\"\r\n                    inputProps={{ readOnly }}\r\n                    style={{ width: 80 }}\r\n                    error={Boolean(touched.effect_year && errors.effect_year)}\r\n                    helperText={touched.effect_year && errors.effect_year}\r\n                  />\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    year\r\n                  </Typography>\r\n                  <TextField\r\n                    {...getFieldProps('effect_month')}\r\n                    variant=\"standard\"\r\n                    inputProps={{ readOnly }}\r\n                    style={{ width: 80 }}\r\n                    error={Boolean(touched.effect_month && errors.effect_month)}\r\n                    helperText={touched.effect_month && errors.effect_month}\r\n                  />\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    month\r\n                  </Typography>\r\n                  <TextField\r\n                    {...getFieldProps('effect_day')}\r\n                    variant=\"standard\"\r\n                    inputProps={{ readOnly }}\r\n                    style={{ width: 80 }}\r\n                    error={Boolean(touched.effect_day && errors.effect_day)}\r\n                    helperText={touched.effect_day && errors.effect_day}\r\n                  />\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    day (East America Time from 00:01 AM)\r\n                  </Typography>\r\n                </Stack>\r\n\r\n                <Stack direction={{ xs: 'column', sm: 'row' }} spacing={{ xs: 3, sm: 2 }}>\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    Permissions Valid period&nbsp;&nbsp;&nbsp;\r\n                  </Typography>\r\n                  <TextField\r\n                    {...getFieldProps('valid_period')}\r\n                    variant=\"standard\"\r\n                    inputProps={{ readOnly }}\r\n                    style={{ width: 150 }}\r\n                    error={Boolean(touched.valid_period && errors.valid_period)}\r\n                    helperText={touched.valid_period && errors.valid_period}\r\n                  />\r\n                  <Typography variant=\"body1\" component=\"div\" style={{ lineHeight: 2 }}>\r\n                    day\r\n                  </Typography>\r\n                </Stack>\r\n\r\n                {!readOnly && (\r\n                  <Box sx={{ mt: 3, display: 'flex', justifyContent: 'flex-end' }}>\r\n                    <Stack direction={{ xs: 'column', sm: 'row' }} spacing={{ xs: 3, sm: 2 }}>\r\n                      {userSpecialPermissions && (\r\n                        <LoadingButton type=\"button\" color=\"secondary\" variant=\"contained\" onClick={onClear}>\r\n                          Clear Special Permissions\r\n                        </LoadingButton>\r\n                      )}\r\n                      <LoadingButton type=\"submit\" variant=\"contained\" loading={isSubmitting}>\r\n                        Save Changes\r\n                      </LoadingButton>\r\n                    </Stack>\r\n                  </Box>\r\n                )}\r\n              </Stack>\r\n            </Card>\r\n          </Grid>\r\n        </Grid>\r\n      </Form>\r\n      {clearConfirm && (\r\n        <ConfirmDialog\r\n          message=\"Are you sure you are going to clear this user's special permission?\"\r\n          onConfirm={handleClear}\r\n          onClose={handleCloseClearConfirm}\r\n        />\r\n      )}\r\n    </FormikProvider>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}